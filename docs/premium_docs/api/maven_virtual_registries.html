<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Manage virtual registries</title>
    <link rel="stylesheet" href="/../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: Package
group: Package Registry
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
title: Maven virtual registry API</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
<li>Status: Beta</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/161615">Introduced</a> in GitLab 17.4 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>virtual_registry_maven</code>. Disabled by default.</li>
<li>Feature flag <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/540276">changed</a> to <code>maven_virtual_registry</code> in GitLab 18.1. Disabled by default. Feature flag <code>virtual_registry_maven</code> removed.</li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/540276">Changed</a> from experiment to beta in GitLab 18.1.</li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/197432">Enabled on GitLab.com, GitLab Self-Managed, and GitLab Dedicated</a> in GitLab 18.2.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>{{&lt; alert type="flag" &gt;}}</p>
<p>The availability of these endpoints is controlled by a feature flag.
For more information, see the history.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>Use this API to:</p>
<ul>
<li>Create and manage Maven virtual registries.</li>
<li>Configure upstream registries.</li>
<li>Manage cache entries.</li>
<li>Handle package downloads and uploads.</li>
</ul>
<h2>Manage virtual registries</h2>
<p>Use the following endpoints to create and manage Maven virtual registries.</p>
<h3>List all virtual registries</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><code>downloads_count</code> and <code>downloaded_at</code> <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/201790">introduced</a> in GitLab 18.4.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Lists all Maven virtual registries for a group.</p>
<pre><code class="language-plaintext">GET /groups/:id/-/virtual_registries/packages/maven/registries
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">string/integer</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">The group ID or full group path. Must be a top-level group.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/groups/5/-/virtual_registries/packages/maven/registries&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 1,
    &quot;group_id&quot;: 5,
    &quot;name&quot;: &quot;my-virtual-registry&quot;,
    &quot;description&quot;: &quot;My virtual registry&quot;,
    &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
    &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;
  }
]
</code></pre>
<h3>Create a virtual registry</h3>
<p>Creates a Maven virtual registry for a group.</p>
<pre><code class="language-plaintext">POST /groups/:id/-/virtual_registries/packages/maven/registries
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>string/integer</td>
<td>yes</td>
<td>The group ID or full group path. Must be a top-level group.</td>
</tr>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>yes</td>
<td>The name of the virtual registry.</td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>no</td>
<td>The description of the virtual registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request POST \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --header &quot;Accept: application/json&quot; \
     --data '{&quot;name&quot;: &quot;my-virtual-registry&quot;, &quot;description&quot;: &quot;My virtual registry&quot;}' \
     --url &quot;https://gitlab.example.com/api/v4/groups/5/-/virtual_registries/packages/maven/registries&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;group_id&quot;: 5,
  &quot;name&quot;: &quot;my-virtual-registry&quot;,
  &quot;description&quot;: &quot;My virtual registry&quot;,
  &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
  &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;
}
</code></pre>
<h3>Get a virtual registry</h3>
<p>Gets a specific Maven virtual registry.</p>
<pre><code class="language-plaintext">GET /virtual_registries/packages/maven/registries/:id
</code></pre>
<p>Parameters:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the Maven virtual registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registries/1&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;group_id&quot;: 5,
  &quot;name&quot;: &quot;my-virtual-registry&quot;,
  &quot;description&quot;: &quot;My virtual registry&quot;,
  &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
  &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;
}
</code></pre>
<h3>Update a virtual registry</h3>
<p>Updates a specific Maven virtual registry.</p>
<pre><code class="language-plaintext">PATCH /virtual_registries/packages/maven/registries/:id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the Maven virtual registry.</td>
</tr>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>yes</td>
<td>The name of the virtual registry.</td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>no</td>
<td>The description of the virtual registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request PATCH \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --data '{&quot;name&quot;: &quot;my-virtual-registry&quot;, &quot;description&quot;: &quot;My virtual registry&quot;}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registries/1&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>200 OK</code></a> status code.</p>
<h3>Delete a virtual registry</h3>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>Deleting a virtual registry also deletes all associated upstream registries that are not shared with other virtual registries, along with their cache entries.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>Deletes a specific Maven virtual registry.</p>
<pre><code class="language-plaintext">DELETE /virtual_registries/packages/maven/registries/:id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the Maven virtual registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request DELETE --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registries/1&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>204 No Content</code></a> status code.</p>
<h3>Delete cache entries for a virtual registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/538327">Introduced</a> in GitLab 18.2 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Enabled by default.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Schedule all cache entries for deletion in all exclusive upstream registries for a Maven virtual registry. Cache entries are not scheduled for deletion for upstream registries that are associated with other virtual registries.</p>
<pre><code class="language-plaintext">DELETE /virtual_registries/packages/maven/registries/:id/cache
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the Maven virtual registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request DELETE --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registries/1/cache&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>204 No Content</code></a> status code.</p>
<h2>Manage upstream registries</h2>
<p>Use the following endpoints to configure and manage upstream Maven registries.</p>
<h3>List all upstream registries for a top-level group</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/550728">Introduced</a> in GitLab 18.3 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Enabled by default.</li>
<li><code>upstream_name</code> <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/561675">introduced</a> in GitLab 18.4.
{{&lt; /history &gt;}}</li>
</ul>
<p>Lists all upstream registries for a top-level group.</p>
<pre><code class="language-plaintext">GET /groups/:id/-/virtual_registries/packages/maven/upstreams
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">string/integer</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">The group ID or full group path. Must be a top-level group.</td>
</tr>
<tr>
<td style="text-align: left;"><code>page</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">The page number. Defaults to 1.</td>
</tr>
<tr>
<td style="text-align: left;"><code>per_page</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">The number of items per page. Defaults to 20.</td>
</tr>
<tr>
<td style="text-align: left;"><code>upstream_name</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">The name of the upstream registry for fuzzy search filtering by name.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/groups/5/-/virtual_registries/packages/maven/upstreams&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 1,
    &quot;group_id&quot;: 5,
    &quot;url&quot;: &quot;https://repo.maven.apache.org/maven2&quot;,
    &quot;name&quot;: &quot;Maven Central&quot;,
    &quot;description&quot;: &quot;Maven Central repository&quot;,
    &quot;cache_validity_hours&quot;: 24,
    &quot;metadata_cache_validity_hours&quot;: 24,
    &quot;username&quot;: &quot;user&quot;,
    &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
    &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;
  }
]
</code></pre>
<h3>Test connection before creating an upstream registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/535637">Introduced</a> in GitLab 18.3 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Enabled by default.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Tests the connection to a Maven upstream registry that has not yet been added to the virtual registry. This endpoint validates connectivity and credentials before creating the upstream registry.</p>
<pre><code class="language-plaintext">POST /groups/:id/-/virtual_registries/packages/maven/upstreams/test
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">string/integer</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">The group ID or full group path. Must be a top-level group.</td>
</tr>
<tr>
<td style="text-align: left;"><code>url</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">The URL of the upstream registry.</td>
</tr>
<tr>
<td style="text-align: left;"><code>password</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">The password of the upstream registry.</td>
</tr>
<tr>
<td style="text-align: left;"><code>username</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">The username of the upstream registry.</td>
</tr>
</tbody>
</table>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>You must include both the <code>username</code> and <code>password</code> in the request, or neither. If not set, a public (anonymous) request is used to test the connection.</p>
<p>{{&lt; /alert &gt;}}</p>
<h4>Test workflow</h4>
<p>The <code>test</code> endpoint sends a HEAD request to the provided upstream URL using a test path to validate connectivity and authentication. The response received from the HEAD request is interpreted as follows:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Upstream Response</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">2XX</td>
<td style="text-align: left;">Success - upstream accessible</td>
<td style="text-align: left;"><code>{ "success": true }</code></td>
</tr>
<tr>
<td style="text-align: left;">404</td>
<td style="text-align: left;">Success - upstream accessible, but test artifact not found</td>
<td style="text-align: left;"><code>{ "success": true }</code></td>
</tr>
<tr>
<td style="text-align: left;">401</td>
<td style="text-align: left;">Authentication failed</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 401 - Unauthorized" }</code></td>
</tr>
<tr>
<td style="text-align: left;">403</td>
<td style="text-align: left;">Access forbidden</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 403 - Forbidden" }</code></td>
</tr>
<tr>
<td style="text-align: left;">5XX</td>
<td style="text-align: left;">Upstream server error</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 5XX - Server Error" }</code></td>
</tr>
<tr>
<td style="text-align: left;">Network errors</td>
<td style="text-align: left;">Connection or timeout issues</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: Connection timeout" }</code></td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/groups/5/-/virtual_registries/packages/maven/upstreams/test&quot; \
     --data '{&quot;url&quot;: &quot;https://repo.maven.apache.org/maven2&quot;}'
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>
<h3>List all upstream registries for a virtual registry</h3>
<p>Lists all upstream registries for a Maven virtual registry.</p>
<pre><code class="language-plaintext">GET /virtual_registries/packages/maven/registries/:id/upstreams
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">The ID of the Maven virtual registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registries/1/upstreams&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 1,
    &quot;group_id&quot;: 5,
    &quot;url&quot;: &quot;https://repo.maven.apache.org/maven2&quot;,
    &quot;name&quot;: &quot;Maven Central&quot;,
    &quot;description&quot;: &quot;Maven Central repository&quot;,
    &quot;cache_validity_hours&quot;: 24,
    &quot;metadata_cache_validity_hours&quot;: 24,
    &quot;username&quot;: &quot;user&quot;,
    &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
    &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
    &quot;registry_upstream&quot;: {
      &quot;id&quot;: 1,
      &quot;registry_id&quot;: 1,
      &quot;position&quot;: 1
    }
  }
]
</code></pre>
<h3>Create an upstream registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><code>metadata_cache_validity_hours</code> <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/556138">introduced</a> in GitLab 18.3.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Adds an upstream registry to a Maven virtual registry.</p>
<pre><code class="language-plaintext">POST /virtual_registries/packages/maven/registries/:id/upstreams
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>Yes</td>
<td>The ID of the Maven virtual registry.</td>
</tr>
<tr>
<td><code>url</code></td>
<td>string</td>
<td>Yes</td>
<td>The URL of the upstream registry.</td>
</tr>
<tr>
<td><code>cache_validity_hours</code></td>
<td>integer</td>
<td>No</td>
<td>The cache validity period. Defaults to 24 hours.</td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>No</td>
<td>The description of the upstream registry.</td>
</tr>
<tr>
<td><code>metadata_cache_validity_hours</code></td>
<td>integer</td>
<td>No</td>
<td>The metadata cache validity period. Defaults to 24 hours.</td>
</tr>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>No</td>
<td>The name of the upstream registry.</td>
</tr>
<tr>
<td><code>password</code></td>
<td>string</td>
<td>No</td>
<td>The password of the upstream registry.</td>
</tr>
<tr>
<td><code>username</code></td>
<td>string</td>
<td>No</td>
<td>The username of the upstream registry.</td>
</tr>
</tbody>
</table>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>You must include both the <code>username</code> and <code>password</code> in the request, or not at all. If not set, a public (anonymous) request is used to access the upstream.</p>
<p>You cannot add two upstreams with the same URL and credentials (<code>username</code> and <code>password</code>) to the same top-level group. Instead, you can either:</p>
<ul>
<li>Set different credentials for each upstream with the same URL.</li>
<li><a href="#associate-an-upstream-with-a-registry">Associate an upstream</a> with multiple virtual registries.
{{&lt; /alert &gt;}}</li>
</ul>
<p>Example request:</p>
<pre><code class="language-shell">curl --request POST --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --data '{&quot;url&quot;: &quot;https://repo.maven.apache.org/maven2&quot;, &quot;name&quot;: &quot;Maven Central&quot;, &quot;description&quot;: &quot;Maven Central repository&quot;, &quot;username&quot;: &lt;your_username&gt;, &quot;password&quot;: &lt;your_password&gt;, &quot;cache_validity_hours&quot;: 48, &quot;metadata_cache_validity_hours&quot;: 1}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registries/1/upstreams&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;group_id&quot;: 5,
  &quot;url&quot;: &quot;https://repo.maven.apache.org/maven2&quot;,
  &quot;name&quot;: &quot;Maven Central&quot;,
  &quot;description&quot;: &quot;Maven Central repository&quot;,
  &quot;cache_validity_hours&quot;: 48,
  &quot;metadata_cache_validity_hours&quot;: 1,
  &quot;username&quot;: &quot;user&quot;,
  &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
  &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
  &quot;registry_upstream&quot;: {
    &quot;id&quot;: 1,
    &quot;registry_id&quot;: 1,
    &quot;position&quot;: 1
  }
}
</code></pre>
<h3>Get an upstream registry</h3>
<p>Gets a specific upstream registry for a Maven virtual registry.</p>
<pre><code class="language-plaintext">GET /virtual_registries/packages/maven/upstreams/:id
</code></pre>
<p>Parameters:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the upstream registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;group_id&quot;: 5,
  &quot;url&quot;: &quot;https://repo.maven.apache.org/maven2&quot;,
  &quot;name&quot;: &quot;Maven Central&quot;,
  &quot;description&quot;: &quot;Maven Central repository&quot;,
  &quot;cache_validity_hours&quot;: 24,
  &quot;metadata_cache_validity_hours&quot;: 24,
  &quot;username&quot;: &quot;user&quot;,
  &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
  &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
  &quot;registry_upstreams&quot;: [
    {
      &quot;id&quot;: 1,
      &quot;registry_id&quot;: 1,
      &quot;position&quot;: 1
    }
  ]
}
</code></pre>
<h3>Update an upstream registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><code>metadata_cache_validity_hours</code> <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/556138">introduced</a> in GitLab 18.3.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Updates a specific upstream registry for a Maven virtual registry.</p>
<pre><code class="language-plaintext">PATCH /virtual_registries/packages/maven/upstreams/:id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>Yes</td>
<td>The ID of the upstream registry.</td>
</tr>
<tr>
<td><code>cache_validity_hours</code></td>
<td>integer</td>
<td>No</td>
<td>The cache validity period. Defaults to 24 hours.</td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>No</td>
<td>The description of the upstream registry.</td>
</tr>
<tr>
<td><code>metadata_cache_validity_hours</code></td>
<td>integer</td>
<td>No</td>
<td>The metadata cache validity period. Defaults to 24 hours.</td>
</tr>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>No</td>
<td>The name of the upstream registry.</td>
</tr>
<tr>
<td><code>password</code></td>
<td>string</td>
<td>No</td>
<td>The password of the upstream registry.</td>
</tr>
<tr>
<td><code>url</code></td>
<td>string</td>
<td>No</td>
<td>The URL of the upstream registry.</td>
</tr>
<tr>
<td><code>username</code></td>
<td>string</td>
<td>No</td>
<td>The username of the upstream registry.</td>
</tr>
</tbody>
</table>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>You must provide at least one of the optional parameters in your request.</p>
<p>The <code>username</code> and <code>password</code> must be provided together, or not at all. If not set, a public (anonymous) request is used to access the upstream.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>Example request:</p>
<pre><code class="language-shell">curl --request PATCH --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --data '{&quot;cache_validity_hours&quot;: 72}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>200 OK</code></a> status code.</p>
<h3>Update an upstream registry position</h3>
<p>Updates the position of an upstream registry in an ordered list for a Maven virtual registry.</p>
<pre><code class="language-plaintext">PATCH /virtual_registries/packages/maven/registry_upstreams/:id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the upstream registry.</td>
</tr>
<tr>
<td><code>position</code></td>
<td>integer</td>
<td>yes</td>
<td>The position of the upstream registry. Between 1 and 20.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request PATCH --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --data '{&quot;position&quot;: 5}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registry_upstreams/1&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>200 OK</code></a> status code.</p>
<h3>Delete an upstream registry</h3>
<p>Deletes a specific upstream registry for a Maven virtual registry.</p>
<pre><code class="language-plaintext">DELETE /virtual_registries/packages/maven/upstreams/:id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the upstream registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request DELETE --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>204 No Content</code></a> status code.</p>
<h3>Associate an upstream with a registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/540276">Introduced</a> in GitLab 18.1 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Disabled by default.</li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/197432">Enabled on GitLab.com, GitLab Self-Managed, and GitLab Dedicated</a> in GitLab 18.2.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Associates an existing upstream registry with a Maven virtual registry.</p>
<pre><code class="language-plaintext">POST /virtual_registries/packages/maven/registry_upstreams
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>registry_id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the Maven virtual registry.</td>
</tr>
<tr>
<td><code>upstream_id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the Maven upstream registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request POST \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --header &quot;Accept: application/json&quot; \
     --data '{&quot;registry_id&quot;: 1, &quot;upstream_id&quot;: 2}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registry_upstreams&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 5,
  &quot;registry_id&quot;: 1,
  &quot;upstream_id&quot;: 2,
  &quot;position&quot;: 2
}
</code></pre>
<h3>Disassociate an upstream from a registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/540276">Introduced</a> in GitLab 18.1 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Disabled by default.</li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/197432">Enabled on GitLab.com, GitLab Self-Managed, and GitLab Dedicated</a> in GitLab 18.2.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Removes the association between an upstream registry and a Maven virtual registry.</p>
<pre><code class="language-plaintext">DELETE /virtual_registries/packages/maven/registry_upstreams/:id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the registry upstream association.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request DELETE \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/registry_upstreams/1&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>204 No Content</code></a> status code.</p>
<h3>Delete cache entries for an upstream registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/538327">Introduced</a> in GitLab 18.2 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Enabled by default.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Schedules all cache entries for deletion for a specific upstream registry in a Maven virtual registry.</p>
<pre><code class="language-plaintext">DELETE /virtual_registries/packages/maven/upstreams/:id/cache
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the upstream registry.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request DELETE --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1/cache&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>204 No Content</code></a> status code.</p>
<h3>Test connection to an upstream registry</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/535637">Introduced</a> in GitLab 18.3 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Enabled by default.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Tests the connection to an existing Maven upstream registry.</p>
<pre><code class="language-plaintext">GET /virtual_registries/packages/maven/upstreams/:id/test
</code></pre>
<h4>How the test works</h4>
<p>The endpoint performs a HEAD request to the upstream URL using the test path to validate connectivity and authentication. If the upstream has a cached artifact, its relative path is used for testing. Otherwise, a dummy path is used. The response received from the HEAD request is interpreted as follows:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Upstream Response</th>
<th style="text-align: left;">Meaning</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">2XX</td>
<td style="text-align: left;">Success - upstream accessible</td>
<td style="text-align: left;"><code>{ "success": true }</code></td>
</tr>
<tr>
<td style="text-align: left;">404</td>
<td style="text-align: left;">Success - upstream accessible but test artifact not found</td>
<td style="text-align: left;"><code>{ "success": true }</code></td>
</tr>
<tr>
<td style="text-align: left;">401</td>
<td style="text-align: left;">Authentication failed</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 401 - Unauthorized" }</code></td>
</tr>
<tr>
<td style="text-align: left;">403</td>
<td style="text-align: left;">Access forbidden</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 403 - Forbidden" }</code></td>
</tr>
<tr>
<td style="text-align: left;">5XX</td>
<td style="text-align: left;">Upstream server error</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 5XX - Server Error" }</code></td>
</tr>
<tr>
<td style="text-align: left;">Network errors</td>
<td style="text-align: left;">Connection/timeout issues</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: Connection timeout" }</code></td>
</tr>
</tbody>
</table>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>Both <code>2XX</code> (found) and <code>404</code> (not found) responses indicate successful connectivity and authentication to the upstream registry. The test validates that GitLab can reach and authenticate with the upstream, not whether a specific artifact exists.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1/test&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>
<h3>Test connection to an upstream registry with override parameters</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/565897">Introduced</a> in GitLab 18.7 <a href="../administration/feature_flags/_index.html">with a flag</a> named <code>maven_virtual_registry</code>. Enabled by default.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Tests the connection to an existing Maven upstream registry with optional parameter overrides.</p>
<p>This way, you can test changes to the URL, username, or password before updating the upstream registry configuration.</p>
<pre><code class="language-plaintext">POST /virtual_registries/packages/maven/upstreams/:id/test
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>Yes</td>
<td>The ID of the upstream registry.</td>
</tr>
<tr>
<td><code>password</code></td>
<td>string</td>
<td>No</td>
<td>The override password for testing.</td>
</tr>
<tr>
<td><code>url</code></td>
<td>string</td>
<td>No</td>
<td>The override URL for testing. If provided, tests connection to this URL instead of the upstream's configured URL.</td>
</tr>
<tr>
<td><code>username</code></td>
<td>string</td>
<td>No</td>
<td>The override username for testing.</td>
</tr>
</tbody>
</table>
<h4>How the test works</h4>
<p>The endpoint performs a HEAD request to the upstream URL
using the test path to validate connectivity and authentication.
If the upstream has a cached artifact, the relative path of the
upstream is used for testing. Otherwise, a placeholder path is used.</p>
<p>The test behavior depends on the parameters provided:</p>
<ul>
<li>No parameters: Tests the upstream with its current configuration (existing URL, username, and password)</li>
<li>URL override: Tests connectivity to the new URL, username and password must be provided together or not at all</li>
<li>Credential override: Tests the existing URL with new credentials</li>
</ul>
<p>The response received from the HEAD request is interpreted as follows:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Upstream Response</th>
<th style="text-align: left;">Meaning</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">2XX</td>
<td style="text-align: left;">Success. Upstream accessible</td>
<td style="text-align: left;"><code>{ "success": true }</code></td>
</tr>
<tr>
<td style="text-align: left;">404</td>
<td style="text-align: left;">Success. Upstream accessible, but test artifact not found</td>
<td style="text-align: left;"><code>{ "success": true }</code></td>
</tr>
<tr>
<td style="text-align: left;">401</td>
<td style="text-align: left;">Authentication failed</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 401 - Unauthorized" }</code></td>
</tr>
<tr>
<td style="text-align: left;">403</td>
<td style="text-align: left;">Access forbidden</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 403 - Forbidden" }</code></td>
</tr>
<tr>
<td style="text-align: left;">5XX</td>
<td style="text-align: left;">Upstream server error</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: 5XX - Server Error" }</code></td>
</tr>
<tr>
<td style="text-align: left;">Network errors</td>
<td style="text-align: left;">Connection or timeout issues</td>
<td style="text-align: left;"><code>{ "success": false, "result": "Error: Connection timeout" }</code></td>
</tr>
</tbody>
</table>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>Both <code>2XX</code> (found) and <code>404</code> (not found) responses indicate successful connectivity and authentication to the upstream registry. The test does not validate whether a specific artifact exists.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>Example request (test existing configuration):</p>
<pre><code class="language-shell">curl --request POST \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1/test&quot;
</code></pre>
<p>Example request (test with URL override and no credentials):</p>
<pre><code class="language-shell">curl --request POST \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --data '{&quot;url&quot;: &quot;&lt;https://new-repo.example.com/maven2&gt;&quot;}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1/test&quot;
</code></pre>
<p>Example request (test with URL and credential override):</p>
<pre><code class="language-shell">curl --request POST \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --data '{&quot;url&quot;: &quot;&lt;https://new-repo.example.com/maven2&gt;&quot;, &quot;username&quot;: &quot;&lt;newuser&gt;&quot;, &quot;password&quot;: &quot;&lt;newpass&gt;&quot;}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1/test&quot;
</code></pre>
<p>Example request (test with credential override):</p>
<pre><code class="language-shell">curl --request POST \
     --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Content-Type: application/json&quot; \
     --data '{&quot;username&quot;: &quot;&lt;newuser&gt;&quot;, &quot;password&quot;: &quot;&lt;newpass&gt;&quot;}' \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1/test&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>
<h2>Manage cache entries</h2>
<p>Use the following endpoints to manage cache entries for a Maven virtual registry.</p>
<h3>List upstream registry cache entries</h3>
<p>Lists cache entries for a Maven upstream registry.</p>
<pre><code class="language-plaintext">GET /virtual_registries/packages/maven/upstreams/:id/cache_entries
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">The ID of the upstream registry.</td>
</tr>
<tr>
<td style="text-align: left;"><code>page</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">The page number. Defaults to 1.</td>
</tr>
<tr>
<td style="text-align: left;"><code>per_page</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">The number of items per page. Defaults to 20.</td>
</tr>
<tr>
<td style="text-align: left;"><code>search</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">The search query for the relative path of the package (for example, <code>foo/bar/mypkg</code>).</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/upstreams/1/cache_entries?search=foo/bar&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: &quot;MTUgZm9vL2Jhci9teXBrZy8xLjAtU05BUFNIT1QvbXlwa2ctMS4wLVNOQVBTSE9ULmphcg==&quot;,
    &quot;group_id&quot;: 5,
    &quot;upstream_id&quot;: 1,
    &quot;upstream_checked_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
    &quot;file_md5&quot;: &quot;44f21d5190b5a6df8089f54799628d7e&quot;,
    &quot;file_sha1&quot;: &quot;74d101856d26f2db17b39bd22d3204021eb0bf7d&quot;,
    &quot;size&quot;: 2048,
    &quot;relative_path&quot;: &quot;foo/bar/package-1.0.0.pom&quot;,
    &quot;content_type&quot;: &quot;application/xml&quot;,
    &quot;upstream_etag&quot;: &quot;\&quot;686897696a7c876b7e\&quot;&quot;,
    &quot;created_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
    &quot;updated_at&quot;: &quot;2024-05-30T12:28:27.855Z&quot;,
    &quot;downloads_count&quot;: 6,
    &quot;downloaded_at&quot;: &quot;2024-06-05T14:58:32.855Z&quot;
  }
]
</code></pre>
<h3>Delete an upstream registry cache entry</h3>
<p>Deletes a specific cache entry for a Maven upstream registry.</p>
<pre><code class="language-plaintext">DELETE /virtual_registries/packages/maven/cache_entries/*id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Yes</td>
<td>The base64-encoded upstream ID and relative path of the cache entry (for example, 'Zm9vL2Jhci9teXBrZy5wb20=').</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --request DELETE --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --header &quot;Accept: application/json&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/cache_entries/Zm9vL2Jhci9teXBrZy5wb20=&quot;
</code></pre>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>204 No Content</code></a> status code.</p>
<h2>Manage package operations</h2>
<p>Use the following endpoints to manage package operations for a Maven virtual registry.</p>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>These endpoints are intended for internal use by GitLab, and generally not meant for manual consumption.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>These endpoints do not adhere to the <a href="rest/authentication.html">REST API authentication methods</a>.
For more information on which headers and token types are supported,
see <a href="../user/packages/virtual_registry/maven/_index.html">Maven virtual registry</a>. Undocumented authentication methods might be removed in the future.</p>
<p>{{&lt; /alert &gt;}}</p>
<h3>Download a package</h3>
<p>Downloads a package from a Maven virtual registry. To access this resource, you must <a href="../user/packages/package_registry/supported_functionality.md#authenticate-with-the-registry">authenticate with the registry</a>.</p>
<pre><code class="language-plaintext">GET /virtual_registries/packages/maven/:id/*path
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">The ID of the Maven virtual registry.</td>
</tr>
<tr>
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">The full package path (for example, <code>foo/bar/mypkg/1.0-SNAPSHOT/mypkg-1.0-SNAPSHOT.jar</code>).</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
     --url &quot;https://gitlab.example.com/api/v4/virtual_registries/packages/maven/1/foo/bar/mypkg/1.0-SNAPSHOT/mypkg-1.0-SNAPSHOT.jar&quot; \
     --output mypkg-1.0-SNAPSHOT.jar
</code></pre>
<p>If successful, returns <a href="rest/troubleshooting.md#status-codes"><code>200 OK</code></a> and
the following response headers:</p>
<ul>
<li><code>x-checksum-sha1</code>: SHA1 checksum of the file</li>
<li><code>x-checksum-md5</code>: MD5 checksum of the file</li>
<li><code>Content-Type</code>: The MIME type of the file</li>
<li><code>Content-Length</code>: The file size in bytes</li>
</ul>
<h3>Upload a package</h3>
<p>Uploads a package to a Maven virtual registry. This endpoint is accessible only by <a href="../development/workhorse/_index.html">GitLab Workhorse</a>.</p>
<pre><code class="language-plaintext">POST /virtual_registries/packages/maven/:id/*path/upload
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>Yes</td>
<td>The ID of the Maven virtual registry.</td>
</tr>
<tr>
<td><code>file</code></td>
<td>file</td>
<td>Yes</td>
<td>The file being uploaded.</td>
</tr>
<tr>
<td><code>path</code></td>
<td>string</td>
<td>Yes</td>
<td>The full package path (for example, <code>foo/bar/mypkg/1.0-SNAPSHOT/mypkg-1.0-SNAPSHOT.jar</code>).</td>
</tr>
</tbody>
</table>
<p>Request headers:</p>
<ul>
<li><code>Etag</code>: Entity tag for the file</li>
<li><code>GitLab-Workhorse-Send-Dependency-Content-Type</code>: Content type of the file</li>
<li><code>Upstream-GID</code>: Global ID of the target upstream</li>
</ul>
<p>If successful, returns a <a href="rest/troubleshooting.md#status-codes"><code>200 OK</code></a> status code.</p></code></pre>
</body>
</html>
