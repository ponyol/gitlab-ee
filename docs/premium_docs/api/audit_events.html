<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Instance audit events</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: Software Supply Chain Security
group: Compliance
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
title: Audit events API</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/386322">Author Email added to the response body</a> in GitLab 15.9.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<h2>Instance audit events</h2>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>Use this API to retrieve <a href="../administration/compliance/audit_event_reports.html">instance audit events</a>.</p>
<p>To retrieve audit events using the API, you must <a href="rest/authentication.html">authenticate yourself</a> as an Administrator.</p>
<h3>Retrieve all instance audit events</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Support for keyset pagination <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/367528">introduced</a> in GitLab 15.11.</li>
<li>Entity type <code>Gitlab::Audit::InstanceScope</code> for instance audit events <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/418185">introduced</a> in GitLab 16.2.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Retrieve all available instance audit events, limited to a maximum of 30 days for each query.</p>
<pre><code class="language-plaintext">GET /audit_events
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>created_after</code></td>
<td>string</td>
<td>no</td>
<td>Return audit events created on or after the given time. Format: ISO 8601 (<code>YYYY-MM-DDTHH:MM:SSZ</code>)</td>
</tr>
<tr>
<td><code>created_before</code></td>
<td>string</td>
<td>no</td>
<td>Return audit events created on or before the given time. Format: ISO 8601 (<code>YYYY-MM-DDTHH:MM:SSZ</code>)</td>
</tr>
<tr>
<td><code>entity_type</code></td>
<td>string</td>
<td>no</td>
<td>Return audit events for the given entity type. Valid values are: <code>User</code>, <code>Group</code>, <code>Project</code>, or <code>Gitlab::Audit::InstanceScope</code>.</td>
</tr>
<tr>
<td><code>entity_id</code></td>
<td>integer</td>
<td>no</td>
<td>Return audit events for the given entity ID. Requires <code>entity_type</code> attribute to be present.</td>
</tr>
</tbody>
</table>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>Offset-based pagination was <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/186194">deprecated</a> in GitLab 17.8
and is planned for removal in 19.0. Use <a href="rest/_index.md#keyset-based-pagination">keyset-based</a> pagination instead.
This change is a breaking change.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>This endpoint supports both offset-based and <a href="rest/_index.md#keyset-based-pagination">keyset-based</a> pagination. You should use keyset-based
pagination when requesting consecutive pages of results.</p>
<p>Read more on <a href="rest/_index.md#pagination">pagination</a>.</p>
<pre><code class="language-shell">curl --request GET \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/audit_events&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 1,
    &quot;author_id&quot;: 1,
    &quot;entity_id&quot;: 6,
    &quot;entity_type&quot;: &quot;Project&quot;,
    &quot;details&quot;: {
      &quot;custom_message&quot;: &quot;Project archived&quot;,
      &quot;author_name&quot;: &quot;Administrator&quot;,
      &quot;author_email&quot;: &quot;admin@example.com&quot;,
      &quot;target_id&quot;: &quot;flightjs/flight&quot;,
      &quot;target_type&quot;: &quot;Project&quot;,
      &quot;target_details&quot;: &quot;flightjs/flight&quot;,
      &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
      &quot;entity_path&quot;: &quot;flightjs/flight&quot;
    },
    &quot;created_at&quot;: &quot;2019-08-30T07:00:41.885Z&quot;
  },
  {
    &quot;id&quot;: 2,
    &quot;author_id&quot;: 1,
    &quot;entity_id&quot;: 60,
    &quot;entity_type&quot;: &quot;Group&quot;,
    &quot;details&quot;: {
      &quot;add&quot;: &quot;group&quot;,
      &quot;author_name&quot;: &quot;Administrator&quot;,
      &quot;author_email&quot;: &quot;admin@example.com&quot;,
      &quot;target_id&quot;: &quot;flightjs&quot;,
      &quot;target_type&quot;: &quot;Group&quot;,
      &quot;target_details&quot;: &quot;flightjs&quot;,
      &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
      &quot;entity_path&quot;: &quot;flightjs&quot;
    },
    &quot;created_at&quot;: &quot;2019-08-27T18:36:44.162Z&quot;
  },
  {
    &quot;id&quot;: 3,
    &quot;author_id&quot;: 51,
    &quot;entity_id&quot;: 51,
    &quot;entity_type&quot;: &quot;User&quot;,
    &quot;details&quot;: {
      &quot;change&quot;: &quot;email address&quot;,
      &quot;from&quot;: &quot;hello@flightjs.com&quot;,
      &quot;to&quot;: &quot;maintainer@flightjs.com&quot;,
      &quot;author_name&quot;: &quot;Andreas&quot;,
      &quot;author_email&quot;: &quot;admin@example.com&quot;,
      &quot;target_id&quot;: 51,
      &quot;target_type&quot;: &quot;User&quot;,
      &quot;target_details&quot;: &quot;Andreas&quot;,
      &quot;ip_address&quot;: null,
      &quot;entity_path&quot;: &quot;Andreas&quot;
    },
    &quot;created_at&quot;: &quot;2019-08-22T16:34:25.639Z&quot;
  },
  {
    &quot;id&quot;: 4,
    &quot;author_id&quot;: 43,
    &quot;entity_id&quot;: 1,
    &quot;entity_type&quot;: &quot;Gitlab::Audit::InstanceScope&quot;,
    &quot;details&quot;: {
      &quot;author_name&quot;: &quot;Administrator&quot;,
      &quot;author_class&quot;: &quot;User&quot;,
      &quot;target_id&quot;: 32,
      &quot;target_type&quot;: &quot;AuditEvents::Streaming::InstanceHeader&quot;,
      &quot;target_details&quot;: &quot;unknown&quot;,
      &quot;custom_message&quot;: &quot;Created custom HTTP header with key X-arg.&quot;,
      &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
      &quot;entity_path&quot;: &quot;gitlab_instance&quot;
    },
    &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
    &quot;author_name&quot;: &quot;Administrator&quot;,
    &quot;entity_path&quot;: &quot;gitlab_instance&quot;,
    &quot;target_details&quot;: &quot;unknown&quot;,
    &quot;created_at&quot;: &quot;2023-08-01T11:29:44.764Z&quot;,
    &quot;target_type&quot;: &quot;AuditEvents::Streaming::InstanceHeader&quot;,
    &quot;target_id&quot;: 32,
    &quot;event_type&quot;: &quot;audit_events_streaming_instance_headers_create&quot;
  }
]
</code></pre>
<h3>Retrieve single instance audit event</h3>
<pre><code class="language-plaintext">GET /audit_events/:id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the audit event</td>
</tr>
</tbody>
</table>
<pre><code class="language-shell">curl --request GET \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/audit_events/1&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;author_id&quot;: 1,
  &quot;entity_id&quot;: 6,
  &quot;entity_type&quot;: &quot;Project&quot;,
  &quot;details&quot;: {
    &quot;custom_message&quot;: &quot;Project archived&quot;,
    &quot;author_name&quot;: &quot;Administrator&quot;,
    &quot;author_email&quot;: &quot;admin@example.com&quot;,
    &quot;target_id&quot;: &quot;flightjs/flight&quot;,
    &quot;target_type&quot;: &quot;Project&quot;,
    &quot;target_details&quot;: &quot;flightjs/flight&quot;,
    &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
    &quot;entity_path&quot;: &quot;flightjs/flight&quot;
  },
  &quot;created_at&quot;: &quot;2019-08-30T07:00:41.885Z&quot;
}
</code></pre>
<h2>Group audit events</h2>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Support for keyset pagination <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/333968">introduced</a> in GitLab 15.2.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Use this API to retrieve <a href="../user/compliance/audit_events.md#group-audit-events">group audit events</a>.</p>
<p>A user with:</p>
<ul>
<li>The Owner role can retrieve group audit events of all users.</li>
<li>The Developer or Maintainer role is limited to group audit events based on their individual actions.</li>
</ul>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>Offset-based pagination was <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/186194">deprecated</a> in GitLab 17.8
and is planned for removal in 19.0. Use <a href="rest/_index.md#keyset-based-pagination">keyset-based</a> pagination instead.
This change is a breaking change.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>This endpoint supports both offset-based and <a href="rest/_index.md#keyset-based-pagination">keyset-based</a> pagination. Keyset-based
pagination is recommended when requesting consecutive pages of results.</p>
<h3>Retrieve all group audit events</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Support for keyset pagination <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/333968">introduced</a> in GitLab 15.2.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<pre><code class="language-plaintext">GET /groups/:id/audit_events
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer or string</td>
<td>yes</td>
<td>The ID or <a href="rest/_index.md#namespaced-paths">URL-encoded path</a> of the group</td>
</tr>
<tr>
<td><code>created_after</code></td>
<td>string</td>
<td>no</td>
<td>Return group audit events created on or after the given time. Format: ISO 8601 (<code>YYYY-MM-DDTHH:MM:SSZ)</code></td>
</tr>
<tr>
<td><code>created_before</code></td>
<td>string</td>
<td>no</td>
<td>Return group audit events created on or before the given time. Format: ISO 8601 (<code>YYYY-MM-DDTHH:MM:SSZ</code>)</td>
</tr>
</tbody>
</table>
<p>By default, <code>GET</code> requests return 20 results at a time because the API results
are paginated.</p>
<p>Read more on <a href="rest/_index.md#pagination">pagination</a>.</p>
<pre><code class="language-shell">curl --request GET \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/groups/60/audit_events&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 2,
    &quot;author_id&quot;: 1,
    &quot;entity_id&quot;: 60,
    &quot;entity_type&quot;: &quot;Group&quot;,
    &quot;details&quot;: {
      &quot;custom_message&quot;: &quot;Group marked for deletion&quot;,
      &quot;author_name&quot;: &quot;Administrator&quot;,
      &quot;author_email&quot;: &quot;admin@example.com&quot;,
      &quot;target_id&quot;: &quot;flightjs&quot;,
      &quot;target_type&quot;: &quot;Group&quot;,
      &quot;target_details&quot;: &quot;flightjs&quot;,
      &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
      &quot;entity_path&quot;: &quot;flightjs&quot;
    },
    &quot;created_at&quot;: &quot;2019-08-28T19:36:44.162Z&quot;
  },
  {
    &quot;id&quot;: 1,
    &quot;author_id&quot;: 1,
    &quot;entity_id&quot;: 60,
    &quot;entity_type&quot;: &quot;Group&quot;,
    &quot;details&quot;: {
      &quot;add&quot;: &quot;group&quot;,
      &quot;author_name&quot;: &quot;Administrator&quot;,
      &quot;author_email&quot;: &quot;admin@example.com&quot;,
      &quot;target_id&quot;: &quot;flightjs&quot;,
      &quot;target_type&quot;: &quot;Group&quot;,
      &quot;target_details&quot;: &quot;flightjs&quot;,
      &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
      &quot;entity_path&quot;: &quot;flightjs&quot;
    },
    &quot;created_at&quot;: &quot;2019-08-27T18:36:44.162Z&quot;
  }
]
</code></pre>
<h3>Retrieve a specific group audit event</h3>
<p>Only available to group owners and administrators.</p>
<pre><code class="language-plaintext">GET /groups/:id/audit_events/:audit_event_id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer or string</td>
<td>yes</td>
<td>The ID or <a href="rest/_index.md#namespaced-paths">URL-encoded path</a> of the group</td>
</tr>
<tr>
<td><code>audit_event_id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the audit event</td>
</tr>
</tbody>
</table>
<pre><code class="language-shell">curl --request GET \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/groups/60/audit_events/2&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 2,
  &quot;author_id&quot;: 1,
  &quot;entity_id&quot;: 60,
  &quot;entity_type&quot;: &quot;Group&quot;,
  &quot;details&quot;: {
    &quot;custom_message&quot;: &quot;Group marked for deletion&quot;,
    &quot;author_name&quot;: &quot;Administrator&quot;,
    &quot;author_email&quot;: &quot;admin@example.com&quot;,
    &quot;target_id&quot;: &quot;flightjs&quot;,
    &quot;target_type&quot;: &quot;Group&quot;,
    &quot;target_details&quot;: &quot;flightjs&quot;,
    &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
    &quot;entity_path&quot;: &quot;flightjs&quot;
  },
  &quot;created_at&quot;: &quot;2019-08-28T19:36:44.162Z&quot;
}
</code></pre>
<h2>Project audit events</h2>
<p>Use this API to retrieve <a href="../user/compliance/audit_events.md#project-audit-events">project audit events</a>.</p>
<p>A user with a Maintainer role (or above) can retrieve project audit events of all users.
A user with a Developer role is limited to project audit events based on their individual actions.</p>
<h3>Retrieve all project audit events</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Support for keyset pagination <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/367528">introduced</a> in GitLab 15.10.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<pre><code class="language-plaintext">GET /projects/:id/audit_events
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer or string</td>
<td>yes</td>
<td>The ID or <a href="rest/_index.md#namespaced-paths">URL-encoded path of the project</a></td>
</tr>
<tr>
<td><code>created_after</code></td>
<td>string</td>
<td>no</td>
<td>Return project audit events created on or after the given time. Format: ISO 8601 (<code>YYYY-MM-DDTHH:MM:SSZ</code>)</td>
</tr>
<tr>
<td><code>created_before</code></td>
<td>string</td>
<td>no</td>
<td>Return project audit events created on or before the given time. Format: ISO 8601 (<code>YYYY-MM-DDTHH:MM:SSZ</code>)</td>
</tr>
</tbody>
</table>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>Offset-based pagination was <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/186194">deprecated</a> in GitLab 17.8
and is planned for removal in 19.0. Use <a href="rest/_index.md#keyset-based-pagination">keyset-based</a> pagination instead.
This change is a breaking change.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>By default, <code>GET</code> requests return 20 results at a time because the API results are paginated.
When requesting consecutive pages of results, you should use <a href="rest/_index.md#keyset-based-pagination">keyset pagination</a>.</p>
<p>Read more on <a href="rest/_index.md#pagination">pagination</a>.</p>
<pre><code class="language-shell">curl --request GET \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/projects/7/audit_events&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: 5,
    &quot;author_id&quot;: 1,
    &quot;entity_id&quot;: 7,
    &quot;entity_type&quot;: &quot;Project&quot;,
    &quot;details&quot;: {
        &quot;change&quot;: &quot;prevent merge request approval from committers&quot;,
        &quot;from&quot;: &quot;&quot;,
        &quot;to&quot;: &quot;true&quot;,
        &quot;author_name&quot;: &quot;Administrator&quot;,
        &quot;author_email&quot;: &quot;admin@example.com&quot;,
        &quot;target_id&quot;: 7,
        &quot;target_type&quot;: &quot;Project&quot;,
        &quot;target_details&quot;: &quot;twitter/typeahead-js&quot;,
        &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
        &quot;entity_path&quot;: &quot;twitter/typeahead-js&quot;
    },
    &quot;created_at&quot;: &quot;2020-05-26T22:55:04.230Z&quot;
  },
  {
      &quot;id&quot;: 4,
      &quot;author_id&quot;: 1,
      &quot;entity_id&quot;: 7,
      &quot;entity_type&quot;: &quot;Project&quot;,
      &quot;details&quot;: {
          &quot;change&quot;: &quot;prevent merge request approval from authors&quot;,
          &quot;from&quot;: &quot;false&quot;,
          &quot;to&quot;: &quot;true&quot;,
          &quot;author_name&quot;: &quot;Administrator&quot;,
          &quot;author_email&quot;: &quot;admin@example.com&quot;,
          &quot;target_id&quot;: 7,
          &quot;target_type&quot;: &quot;Project&quot;,
          &quot;target_details&quot;: &quot;twitter/typeahead-js&quot;,
          &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
          &quot;entity_path&quot;: &quot;twitter/typeahead-js&quot;
      },
      &quot;created_at&quot;: &quot;2020-05-26T22:55:04.218Z&quot;
  }
]
</code></pre>
<h3>Retrieve a specific project audit event</h3>
<p>Only available to users with at least the Maintainer role for the project.</p>
<pre><code class="language-plaintext">GET /projects/:id/audit_events/:audit_event_id
</code></pre>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer or string</td>
<td>yes</td>
<td>The ID or <a href="rest/_index.md#namespaced-paths">URL-encoded path of the project</a></td>
</tr>
<tr>
<td><code>audit_event_id</code></td>
<td>integer</td>
<td>yes</td>
<td>The ID of the audit event</td>
</tr>
</tbody>
</table>
<pre><code class="language-shell">curl --request GET \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/projects/7/audit_events/5&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 5,
  &quot;author_id&quot;: 1,
  &quot;entity_id&quot;: 7,
  &quot;entity_type&quot;: &quot;Project&quot;,
  &quot;details&quot;: {
      &quot;change&quot;: &quot;prevent merge request approval from committers&quot;,
      &quot;from&quot;: &quot;&quot;,
      &quot;to&quot;: &quot;true&quot;,
      &quot;author_name&quot;: &quot;Administrator&quot;,
      &quot;author_email&quot;: &quot;admin@example.com&quot;,
      &quot;target_id&quot;: 7,
      &quot;target_type&quot;: &quot;Project&quot;,
      &quot;target_details&quot;: &quot;twitter/typeahead-js&quot;,
      &quot;ip_address&quot;: &quot;127.0.0.1&quot;,
      &quot;entity_path&quot;: &quot;twitter/typeahead-js&quot;
  },
  &quot;created_at&quot;: &quot;2020-05-26T22:55:04.230Z&quot;
}
</code></pre></code></pre>
</body>
</html>
