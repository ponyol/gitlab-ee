<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># List all advanced search migrations</title>
    <link rel="stylesheet" href="/../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: AI-powered
group: Global Search
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
title: Search admin API</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab Self-Managed</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/120751">Introduced</a> in GitLab 16.1</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Use this API to retrieve information about <a href="../integration/advanced_search/elasticsearch.md#advanced-search-migrations">advanced search migrations</a>.</p>
<p>Prerequisites:</p>
<ul>
<li>You must be an administrator.</li>
</ul>
<h2>List all advanced search migrations</h2>
<p>Get a list of all advanced search migrations for the GitLab instance.</p>
<pre><code class="language-plaintext">GET /admin/search/migrations
</code></pre>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/admin/search/migrations&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">[
  {
    &quot;version&quot;: 20230427555555,
    &quot;name&quot;: &quot;BackfillHiddenOnMergeRequests&quot;,
    &quot;started_at&quot;: &quot;2023-05-12T01:35:05.469+00:00&quot;,
    &quot;completed_at&quot;: &quot;2023-05-12T01:36:06.432+00:00&quot;,
    &quot;completed&quot;: true,
    &quot;obsolete&quot;: false,
    &quot;migration_state&quot;: {}
  },
  {
    &quot;version&quot;: 20230428500000,
    &quot;name&quot;: &quot;AddSuffixProjectInWikiRid&quot;,
    &quot;started_at&quot;: &quot;2023-05-04T18:59:43.542+00:00&quot;,
    &quot;completed_at&quot;: &quot;2023-05-04T18:59:43.542+00:00&quot;,
    &quot;completed&quot;: false,
    &quot;obsolete&quot;: false,
    &quot;migration_state&quot;: {
      &quot;pause_indexing&quot;: true,
      &quot;slice&quot;: 1,
      &quot;task_id&quot;: null,
      &quot;max_slices&quot;: 5,
      &quot;retry_attempt&quot;: 0
    }
  },
  {
    &quot;version&quot;: 20230503064300,
    &quot;name&quot;: &quot;BackfillProjectPermissionsInBlobsUsingPermutations&quot;,
    &quot;started_at&quot;: &quot;2023-05-03T16:04:44.074+00:00&quot;,
    &quot;completed_at&quot;: &quot;2023-05-03T16:04:44.074+00:00&quot;,
    &quot;completed&quot;: true,
    &quot;obsolete&quot;: false,
    &quot;migration_state&quot;: {
      &quot;permutation_idx&quot;: 8,
      &quot;documents_remaining&quot;: 5,
      &quot;task_id&quot;: &quot;I2_LXc-xQlOeu-KmjYpM8g:172820&quot;,
      &quot;documents_remaining_for_permutation&quot;: 0
    }
  }
]
</code></pre>
<h2>Get an advanced search migration</h2>
<p>Get a single advanced search migration by providing the migration version or name.</p>
<pre><code class="language-plaintext">GET /admin/search/migrations/:version_or_name
</code></pre>
<p>Parameters:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version_or_name</code></td>
<td>integer or string</td>
<td>Yes</td>
<td>The version or name of the migration.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/admin/search/migrations/20230503064300&quot;
curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://primary.example.com/api/v4/admin/search/migrations/BackfillProjectPermissionsInBlobsUsingPermutations&quot;
</code></pre>
<p>If successful, returns <a href="rest/troubleshooting.md#status-codes"><code>200</code></a> and the following
response attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>version</code></td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">Version of the migration.</td>
</tr>
<tr>
<td style="text-align: left;"><code>name</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Name of the migration.</td>
</tr>
<tr>
<td style="text-align: left;"><code>started_at</code></td>
<td style="text-align: left;">datetime</td>
<td style="text-align: left;">Start date for the migration.</td>
</tr>
<tr>
<td style="text-align: left;"><code>completed_at</code></td>
<td style="text-align: left;">datetime</td>
<td style="text-align: left;">Completion date for the migration.</td>
</tr>
<tr>
<td style="text-align: left;"><code>completed</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">If <code>true</code>, the migration is completed.</td>
</tr>
<tr>
<td style="text-align: left;"><code>obsolete</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">If <code>true</code>, the migration has been marked as obsolete.</td>
</tr>
<tr>
<td style="text-align: left;"><code>migration_state</code></td>
<td style="text-align: left;">object</td>
<td style="text-align: left;">Stored migration state.</td>
</tr>
</tbody>
</table>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;version&quot;: 20230503064300,
  &quot;name&quot;: &quot;BackfillProjectPermissionsInBlobsUsingPermutations&quot;,
  &quot;started_at&quot;: &quot;2023-05-03T16:04:44.074+00:00&quot;,
  &quot;completed_at&quot;: &quot;2023-05-03T16:04:44.074+00:00&quot;,
  &quot;completed&quot;: true,
  &quot;obsolete&quot;: false,
  &quot;migration_state&quot;: {
    &quot;permutation_idx&quot;: 8,
    &quot;documents_remaining&quot;: 5,
    &quot;task_id&quot;: &quot;I2_LXc-xQlOeu-KmjYpM8g:172820&quot;,
    &quot;documents_remaining_for_permutation&quot;: 0
  }
}
</code></pre></code></pre>
</body>
</html>
