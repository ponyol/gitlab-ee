<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Get a project's pull mirror details</title>
    <link rel="stylesheet" href="/../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: Create
group: Source Code
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
title: Pull mirroring API
description: Manage pull mirroring for projects. View mirror details, configure mirroring settings, and start mirror updates.</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>Use this API to manage project <a href="../user/project/repository/mirror/pull.html">pull mirroring</a>.</p>
<h2>Get a project's pull mirror details</h2>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/168377">Extended response</a> to include mirror configuration information in GitLab 17.5. The following configuration settings are included: <code>enabled</code>, <code>mirror_trigger_builds</code>, <code>only_mirror_protected_branches</code>, <code>mirror_overwrites_diverged_branches</code>, and <code>mirror_branch_regex</code>.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Return the details of a project's pull mirror.</p>
<pre><code class="language-plaintext">GET /projects/:id/mirror/pull
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">integer or string</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">ID or <a href="rest/_index.md#namespaced-paths">URL-encoded path of the project</a>.</td>
</tr>
</tbody>
</table>
<p>If successful, returns <a href="rest/troubleshooting.md#status-codes"><code>200 OK</code></a> and the
following response attributes:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td>boolean</td>
<td>If <code>true</code>, the mirror is active.</td>
</tr>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>Unique identifier of the mirror configuration.</td>
</tr>
<tr>
<td><code>last_error</code></td>
<td>string or null</td>
<td>Most recent error message, if any. <code>null</code> if no errors occurred.</td>
</tr>
<tr>
<td><code>last_successful_update_at</code></td>
<td>string</td>
<td>Timestamp of the last successful mirror update.</td>
</tr>
<tr>
<td><code>last_update_at</code></td>
<td>string</td>
<td>Timestamp of the most recent mirror update attempt.</td>
</tr>
<tr>
<td><code>last_update_started_at</code></td>
<td>string</td>
<td>Timestamp when the last mirror update process started.</td>
</tr>
<tr>
<td><code>mirror_branch_regex</code></td>
<td>string or null</td>
<td>Regex pattern for filtering which branches to mirror. <code>null</code> if not set.</td>
</tr>
<tr>
<td><code>mirror_overwrites_diverged_branches</code></td>
<td>boolean</td>
<td>If <code>true</code>, overwrites diverged branches during mirroring.</td>
</tr>
<tr>
<td><code>mirror_trigger_builds</code></td>
<td>boolean</td>
<td>If <code>true</code>, triggers builds for mirror updates.</td>
</tr>
<tr>
<td><code>only_mirror_protected_branches</code></td>
<td>boolean or null</td>
<td>If <code>true</code>, only protected branches are mirrored. If not set, the value is <code>null</code>.</td>
</tr>
<tr>
<td><code>update_status</code></td>
<td>string</td>
<td>Status of the mirror update process.</td>
</tr>
<tr>
<td><code>url</code></td>
<td>string</td>
<td>URL of the mirrored repository.</td>
</tr>
</tbody>
</table>
<p>Example request:</p>
<pre><code class="language-shell">curl --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://gitlab.example.com/api/v4/projects/:id/mirror/pull&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 101486,
  &quot;last_error&quot;: null,
  &quot;last_successful_update_at&quot;: &quot;2020-01-06T17:32:02.823Z&quot;,
  &quot;last_update_at&quot;: &quot;2020-01-06T17:32:02.823Z&quot;,
  &quot;last_update_started_at&quot;: &quot;2020-01-06T17:31:55.864Z&quot;,
  &quot;update_status&quot;: &quot;finished&quot;,
  &quot;url&quot;: &quot;https://*****:*****@gitlab.com/gitlab-org/security/gitlab.git&quot;,
  &quot;enabled&quot;: true,
  &quot;mirror_trigger_builds&quot;: true,
  &quot;only_mirror_protected_branches&quot;: null,
  &quot;mirror_overwrites_diverged_branches&quot;: false,
  &quot;mirror_branch_regex&quot;: null
}
</code></pre>
<h2>Configure pull mirroring for a project</h2>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/494294">Introduced</a> in GitLab 17.6.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Configure pull mirroring settings for a project.</p>
<pre><code class="language-plaintext">PUT /projects/:id/mirror/pull
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">integer or string</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">ID or <a href="rest/_index.md#namespaced-paths">URL-encoded path of the project</a>.</td>
</tr>
<tr>
<td style="text-align: left;"><code>auth_password</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Password used for authentication of a project to pull mirror.</td>
</tr>
<tr>
<td style="text-align: left;"><code>auth_user</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Username used for authentication of a project to pull mirror.</td>
</tr>
<tr>
<td style="text-align: left;"><code>enabled</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">If <code>true</code>, enables pull mirroring on project when set to <code>true</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><code>mirror_branch_regex</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Contains a regular expression. Only branches with names matching the regex are mirrored. Requires <code>only_mirror_protected_branches</code> to be disabled.</td>
</tr>
<tr>
<td style="text-align: left;"><code>mirror_overwrites_diverged_branches</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">If <code>true</code>, overwrites diverged branches.</td>
</tr>
<tr>
<td style="text-align: left;"><code>mirror_trigger_builds</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">If <code>true</code>, triggers pipelines for mirror updates.</td>
</tr>
<tr>
<td style="text-align: left;"><code>only_mirror_protected_branches</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">If <code>true</code>, limits mirroring to only protected branches.</td>
</tr>
<tr>
<td style="text-align: left;"><code>url</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">URL of remote repository being mirrored.</td>
</tr>
</tbody>
</table>
<p>If successful, returns <a href="rest/troubleshooting.md#status-codes"><code>200 OK</code></a> and the
updated pull mirror configuration.</p>
<p>Example request to add pull mirroring:</p>
<pre><code class="language-shell">curl --request PUT \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --header &quot;Content-Type: application/json&quot; \
  --data '{
    &quot;enabled&quot;: true,
    &quot;url&quot;: &quot;https://gitlab.example.com/group/project.git&quot;,
    &quot;auth_user&quot;: &quot;user&quot;,
    &quot;auth_password&quot;: &quot;password&quot;
  }' \
  --url &quot;https://gitlab.example.com/api/v4/projects/:id/mirror/pull&quot;
</code></pre>
<p>Example request to remove pull mirroring:</p>
<pre><code class="language-shell">curl --request PUT \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --data &quot;enabled=false&quot; \
  --url &quot;https://gitlab.example.com/api/v4/projects/:id/mirror/pull&quot;
</code></pre>
<p>Example response:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 101486,
  &quot;last_error&quot;: null,
  &quot;last_successful_update_at&quot;: &quot;2020-01-06T17:32:02.823Z&quot;,
  &quot;last_update_at&quot;: &quot;2020-01-06T17:32:02.823Z&quot;,
  &quot;last_update_started_at&quot;: &quot;2020-01-06T17:31:55.864Z&quot;,
  &quot;update_status&quot;: &quot;finished&quot;,
  &quot;url&quot;: &quot;https://gitlab.example.com/group/project.git&quot;,
  &quot;enabled&quot;: true,
  &quot;mirror_trigger_builds&quot;: false,
  &quot;only_mirror_protected_branches&quot;: null,
  &quot;mirror_overwrites_diverged_branches&quot;: false,
  &quot;mirror_branch_regex&quot;: null
}
</code></pre>
<h2>Configure pull mirroring for a project (deprecated)</h2>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Feature flag <code>mirror_only_branches_match_regex</code> <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/381667">enabled by default</a> in GitLab 16.0.</li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/410354">Generally available</a> in GitLab 16.2. Feature flag <code>mirror_only_branches_match_regex</code> removed.</li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/494294">Deprecated</a> in GitLab 17.6.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>This configuration option was <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/494294">deprecated</a> in GitLab 17.6
and is planned for removal in v5 of the API. Use the <a href="project_pull_mirroring.md#configure-pull-mirroring-for-a-project">new configuration and endpoint</a> instead.
This change is a breaking change.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>If the remote repository is publicly accessible or uses <code>username:token</code> authentication, use the API
to configure pull mirroring when <a href="projects.md#create-a-project">creating</a> or <a href="projects.md#edit-a-project">updating</a>
a project.</p>
<p>If your HTTP repository is not publicly accessible, you can add the authentication information to the URL. For example,
<code>https://username:token@gitlab.company.com/group/project.git</code> where <code>token</code> is a
<a href="../user/profile/personal_access_tokens.html">personal access token</a> with the <code>api</code> scope enabled.</p>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>import_url</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">URL of remote repository being mirrored (with <code>user:token</code> if needed).</td>
</tr>
<tr>
<td style="text-align: left;"><code>mirror</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">If <code>true</code>, enables pull mirroring.</td>
</tr>
<tr>
<td style="text-align: left;"><code>mirror_branch_regex</code></td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Contains a regular expression. Only branches with names matching the regex are mirrored. Requires <code>only_mirror_protected_branches</code> to be disabled.</td>
</tr>
<tr>
<td style="text-align: left;"><code>mirror_trigger_builds</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">If <code>true</code>, triggers pipelines for mirror updates.</td>
</tr>
<tr>
<td style="text-align: left;"><code>only_mirror_protected_branches</code></td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">If <code>true</code>, limits mirroring to only protected branches.</td>
</tr>
</tbody>
</table>
<p>Example creating a project with pull mirroring:</p>
<pre><code class="language-shell">curl --request POST \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --header &quot;Content-Type: application/json&quot; \
  --data '{
    &quot;name&quot;: &quot;new_project&quot;,
    &quot;namespace_id&quot;: &quot;1&quot;,
    &quot;mirror&quot;: true,
    &quot;import_url&quot;: &quot;https://username:token@gitlab.example.com/group/project.git&quot;
  }' \
  --url &quot;https://gitlab.example.com/api/v4/projects/&quot;
</code></pre>
<p>Example adding pull mirroring:</p>
<pre><code class="language-shell">curl --request PUT \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --data &quot;mirror=true&amp;import_url=https://username:token@gitlab.example.com/group/project.git&quot; \
  --url &quot;https://gitlab.example.com/api/v4/projects/:id&quot;
</code></pre>
<p>Example removing pull mirroring:</p>
<pre><code class="language-shell">curl --request PUT \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --data &quot;mirror=false&quot; \
  --url &quot;https://gitlab.example.com/api/v4/projects/:id&quot;
</code></pre>
<h2>Start the pull mirroring process for a project</h2>
<p>Start the pull mirroring process for a project.</p>
<pre><code class="language-plaintext">POST /projects/:id/mirror/pull
</code></pre>
<p>Supported attributes:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Required</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>id</code></td>
<td style="text-align: left;">integer or string</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">ID or <a href="rest/_index.md#namespaced-paths">URL-encoded path of the project</a>.</td>
</tr>
</tbody>
</table>
<p>If successful, returns <a href="rest/troubleshooting.md#status-codes"><code>202 Accepted</code></a>.</p>
<p>Example request:</p>
<pre><code class="language-shell">curl --request POST \
  --header &quot;PRIVATE-TOKEN: &lt;your_access_token&gt;&quot; \
  --url &quot;https://gitlab.example.com/api/v4/projects/:id/mirror/pull&quot;
</code></pre></code></pre>
</body>
</html>
