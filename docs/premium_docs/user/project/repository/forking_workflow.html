<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Create a fork</title>
    <link rel="stylesheet" href="/../../../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: Create
group: Source Code
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
description: Fork a Git repository when you want to contribute changes back to an upstream repository you don't have permission to contribute to directly.
title: Forks</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Free, Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>A fork is a personal copy of another Git repository, placed in the namespace of your choice.
Your copy contains the upstream repository's content, including all branches, tags,
and CI/CD job configurations.
You can create merge requests from your fork to target the upstream repository.
Individual commits can also be <a href="../merge_requests/cherry_pick_changes.html">cherry-picked</a> from
your fork into the upstream repository.</p>
<p>If you have write access to the original repository, you don't need a fork.
Instead, use branches to manage your work.
If you don't have write access to a repository you want to contribute to, fork it.
Make your changes in your fork, then submit them through a merge request to the upstream repository.</p>
<p>To create a <a href="../merge_requests/confidential.html">confidential merge request</a>,
use a personal fork of a public repository.</p>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>If the upstream project is archived, the fork relationship is automatically removed.
Merge requests that were closed due to a broken fork relationship are not reopened
if the fork relationship is later restored.</p>
<p>For more information, see <a href="../working_with_projects.md#archive-a-project">Archive a project</a>.</p>
<p>{{&lt; /alert &gt;}}</p>
<h2>Create a fork</h2>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/24894">Introduced</a> in GitLab 16.6.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>To fork an existing project in GitLab:</p>
<ol>
<li>On the project's homepage, in the upper-right corner, select <strong>Fork</strong> ({{&lt; icon name="fork" &gt;}}).</li>
<li>Optional. Edit the <strong>Project name</strong>.</li>
<li>For <strong>Project URL</strong>, select the <a href="../../namespace/_index.html">namespace</a>
   your fork should belong to.</li>
<li>Add a <strong>Project slug</strong>. This value becomes part of the URL to your fork.
   It must be unique in the namespace.</li>
<li>Optional. Add a <strong>Project description</strong>.</li>
<li>Select one of the <strong>Branches to include</strong> options:</li>
<li><strong>All branches</strong> (default).</li>
<li><strong>Only the default branch</strong>. Uses the <code>--single-branch</code> and <code>--no-tags</code>
     <a href="https://git-scm.com/docs/git-clone">Git options</a>.</li>
<li>Select the <strong>Visibility level</strong> for your fork. For more information about
   visibility levels, read <a href="../../public_access.html">Project and group visibility</a>.</li>
<li>Select <strong>Fork project</strong>.</li>
</ol>
<p>GitLab creates your fork, redirects you to the new fork's page, and logs the fork's
creation in the <a href="../../compliance/audit_event_types.html">audit log</a>.</p>
<p>If you intend to contribute changes upstream frequently, consider setting a
<a href="../merge_requests/creating_merge_requests.md#set-the-default-target-project">default target</a> for your fork.</p>
<h2>Update your fork</h2>
<p>A fork can fall out of sync with its upstream repository, and require an update:</p>
<ul>
<li><strong>Ahead</strong>: Your fork contains new commits not present in the upstream repository.
  To sync your fork, create a merge request to push your changes to the upstream repository.</li>
<li><strong>Behind</strong>: The upstream repository contains new commits not present in your fork.
  To sync your fork, pull the new commits into your fork.</li>
<li><strong>Ahead and behind</strong>: Both the upstream repository and your fork contain new commits
  not present in the other. To fully sync your fork, create a merge request to push
  your changes up, and pull the upstream repository's new changes into your fork.</li>
</ul>
<p>To sync your fork with its upstream repository, update it from the GitLab UI
or the command line. GitLab Premium and Ultimate tiers can also automate updates by
<a href="#with-repository-mirroring">configuring forks as pull mirrors</a> of the upstream repository.</p>
<h3>From the UI</h3>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/330243">Generally available</a> in GitLab 16.0. Feature flag <code>synchronize_fork</code> removed.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>When you update a fork from the UI, the following repository protection settings on the fork are
bypassed:</p>
<ul>
<li>Push rules configured on the fork.</li>
<li>File locking applied to files in the fork.</li>
</ul>
<p>This behavior prevents synchronization failures when the upstream project and fork have different
protection configurations. The synchronization process pulls changes from the upstream project and
applies them directly to the fork.</p>
<p>Prerequisites:</p>
<ul>
<li>You must create your fork from an <a href="branches/protected.html">unprotected branch</a> in upstream repository.</li>
</ul>
<p>To update your fork from the GitLab UI:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong>.</li>
<li>Select <strong>View all my projects</strong>.</li>
<li>Select the fork you want to update.</li>
<li>Below the dropdown list for branch name, find the <strong>Forked from</strong> ({{&lt; icon name="fork" &gt;}})
   information box to determine if your fork is ahead, behind, or both. In this example,
   the fork is behind the upstream repository:</li>
</ol>
<p><img alt="Information box for a fork some commits behind the upstream repository" src="img/update-fork_v16_6.png" /></p>
<ol>
<li>If your fork is <strong>ahead</strong> of the upstream repository, select
   <strong>Create merge request</strong> to propose adding your fork's changes to the upstream repository.</li>
<li>If your fork is <strong>behind</strong> the upstream repository, select <strong>Update fork</strong>
   to pull changes from the upstream repository.</li>
<li>If your fork is <strong>ahead and behind</strong> the upstream repository, you can update from the UI
   only if GitLab detects no merge conflicts:</li>
<li>If your fork contains no merge conflicts, you can select <strong>Create merge request</strong>
     to propose pushing your changes to the upstream repository, <strong>Update fork</strong>
     to pull changes down to your fork, or both. The type of changes in your fork
     determine which actions are appropriate.</li>
<li>If your fork contains merge conflicts, GitLab shows a step-by-step guide to update your fork from the command line.</li>
</ol>
<h3>From the command line</h3>
<p>You can also choose to update your fork from the command line.</p>
<p>Prerequisites:</p>
<ul>
<li>You must <a href="../../../topics/git/how_to_install_git/_index.html">download and install the Git client</a> on your local machine.</li>
<li>You must <a href="#create-a-fork">create a fork</a> of the repository you want to update.</li>
</ul>
<p>To update your fork from the command line, follow the instruction in
<a href="../../../topics/git/forks.html">use Git to update a fork</a>.</p>
<h3>With repository mirroring</h3>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>A fork can be configured as a mirror of the upstream if all these conditions are met:</p>
<ol>
<li>Your subscription is GitLab Premium or GitLab Ultimate.</li>
<li>You create all changes in branches (not <code>main</code>).</li>
<li>You do not work on <a href="../merge_requests/confidential.html">merge requests for confidential issues</a>,
   which requires changes to <code>main</code>.</li>
</ol>
<p><a href="mirror/_index.html">Repository mirroring</a> keeps your fork synced with the original repository.
This method updates your fork once per hour, with no manual <code>git pull</code> required.
For instructions, read <a href="mirror/pull.md#configure-pull-mirroring">Configure pull mirroring</a>.</p>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>With mirroring, before approving a merge request, you are asked to sync. You should automate it.</p>
<p>{{&lt; /alert &gt;}}</p>
<h2>Merge changes back upstream</h2>
<p>When you are ready to send your code back to the upstream repository, create a new merge request as
described in <a href="../merge_requests/creating_merge_requests.md#when-you-work-in-a-fork">When you work in a fork</a>.
When successfully merged, your changes are added to the repository and branch you're merging into.</p>
<p>After your merge request is merged upstream, the branch in your fork is not automatically considered
<strong>Merged</strong> for bulk deletion purposes. The branch is only considered merged if your fork's default
branch contains those changes. To mark these branches as merged in your fork,
<a href="#update-your-fork">update your fork</a> to sync with the upstream repository.</p>
<h2>Unlink a fork</h2>
<p>Removing a fork relationship unlinks your fork from its upstream repository.
Your fork then becomes an independent repository.</p>
<p>Prerequisites:</p>
<ul>
<li>You must be a project owner to unlink a fork.</li>
</ul>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>If you remove a fork relationship, you can't send new merge requests to the source.
Any existing open merge requests from the fork to the source are also closed.
If anyone has forked your repository, their fork also loses the relationship.
To restore the fork relationship, <a href="../../../api/project_forks.md#create-a-fork-relationship-between-projects">use the API</a>.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>To remove a fork relationship:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your project.</li>
<li>Select <strong>Settings</strong> &gt; <strong>General</strong>.</li>
<li>Expand <strong>Advanced</strong>.</li>
<li>In the <strong>Remove fork relationship</strong> section, select <strong>Remove fork relationship</strong>.</li>
<li>To confirm, enter the project path and select <strong>Confirm</strong>.</li>
</ol>
<p>GitLab logs the unlink operation in the <a href="../../compliance/audit_event_types.html">audit log</a>.
When you unlink a fork that uses a <a href="../../../administration/repository_storage_paths.md#hashed-object-pools">hashed storage pool</a>
to share objects with another repository:</p>
<ul>
<li>All objects are copied from the pool into your fork.</li>
<li>After the copy process completes, no further updates from the storage pool are propagated to your fork.</li>
</ul>
<h2>Check a fork's storage usage</h2>
<p>Your fork uses a deduplication strategy
to reduce the storage space it needs. Your fork can access the object pool connected to the source repository.</p>
<p>For more information and to check the storage use, see <a href="../../storage_usage_quotas.md#view-project-fork-storage-usage">View project fork storage usage</a>.</p>
<h2>Related topics</h2>
<ul>
<li>GitLab community forum: <a href="https://forum.gitlab.com/t/refreshing-a-fork/32469">Refreshing a fork</a></li>
<li><a href="../../group/access_and_permissions.md#prevent-project-forking-outside-group">Prevent project forking outside group</a></li>
<li><a href="../../../topics/git/lfs/_index.md#understand-how-git-lfs-works-with-forks">Understand how Git LFS works with forks</a></li>
</ul>
<h2>Troubleshooting</h2>
<h3>Error: <code>An error occurred while forking the project. Please try again</code></h3>
<p>This error can be due to a mismatch in instance runner settings between the forked project
and the new namespace. See <a href="../../../ci/runners/configure_runners.md#using-instance-runners-in-forked-projects">Forks</a>
in the Runner documentation for more information.</p>
<h3>Removing fork relationship fails</h3>
<p>If removing the fork through the UI or API is not working, you can attempt the
fork relationship removal in a
<a href="../../../administration/operations/rails_console.md#starting-a-rails-console-session">Rails console session</a>:</p>
<pre><code class="language-ruby">p = Project.find_by_full_path('&lt;project_path&gt;')
u = User.find_by_username('&lt;username&gt;')
Projects::UnlinkForkService.new(p, u).execute
</code></pre>
<h3>Error: <code>User is not allowed to import projects</code></h3>
<p>When forking a project using a service account, you might receive an error that states:</p>
<pre><code class="language-plaintext">{&quot;message&quot;:[&quot;Namespace is not valid&quot;,&quot;User is not allowed to import projects&quot;]}
</code></pre>
<p>This issue occurs because service accounts are bot users and cannot fork projects to their personal namespace, even if their project limit has been increased.</p>
<p>When using a service account to fork a project, the workaround is to specify a target group namespace using either <code>namespace_id</code> or <code>namespace_path</code> in the <a href="../../../api/project_forks.html">Project forks API</a>. The service account must be a member of the target group with at least the Developer role.</p></code></pre>
</body>
</html>
