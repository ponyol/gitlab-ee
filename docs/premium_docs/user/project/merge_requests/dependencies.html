<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Nested dependencies</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: Create
group: Code Review
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
description: Set a merge request dependency to control the merge order of merge requests with related or dependent content.
title: Merge request dependencies</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Support for complex merge dependencies <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/11393">introduced</a> in GitLab 16.6 <a href="../../../administration/feature_flags/_index.html">with a flag</a> named <code>remove_mr_blocking_constraints</code>. Disabled by default.</li>
<li>Support for complex merge dependencies <a href="https://gitlab.com/gitlab-org/gitlab/-/merge_requests/136775">generally available</a> in GitLab 16.7. Feature flag <code>remove_mr_blocking_constraints</code> removed.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>A single feature can span several merge requests, spread out across multiple projects,
and the order in which the work merges can be significant. When you set a merge request dependency,
the dependent merge requests cannot merge until the <strong>Merge request dependencies must be merged</strong>
merge check is satisfied.</p>
<p>Merge request dependencies can help you:</p>
<ul>
<li>Ensure changes to a required library merge before changes to a project that
  imports the library.</li>
<li>Prevent a documentation-only merge request from merging before the feature work
  is itself merged.</li>
<li>Require a merge request updating a permissions matrix to merge, before merging work
  from someone who doesn't yet have the correct permissions.</li>
</ul>
<p>If your project <code>me/myexample</code> imports a library from <code>myfriend/library</code>,
you should update your project when <code>myfriend/library</code> releases a new feature.
If you merge your changes to <code>me/myexample</code> before <code>myfriend/library</code> adds the
new feature, you would break the default branch in your project. A merge request
dependency prevents your work from merging too soon:</p>
<pre><code class="language-mermaid">%%{init: { &quot;fontFamily&quot;: &quot;GitLab Sans&quot; }}%%

graph TB
  accTitle: Merge request dependencies
  accDescr: Shows how a merge request dependency prevents work from merging too soon.
  A['me/myexample' project]
  B['myfriend/library' project]
  C[Merge request #1:&lt;br&gt;Create new version 2.5]
  D[Merge request #2:&lt;br&gt;Add version 2.5&lt;br&gt;to build]
  A--&gt;|contains| D
  B----&gt;|contains| C
  D-.-&gt;|depends on| C
  C-.-&gt;|blocks| D
</code></pre>
<p>It's possible to mark your <code>me/myexample</code> merge request as a <a href="drafts.html">draft</a>
and explain why in the comments. This approach is manual and does not scale, especially
if your merge request relies on several others in different projects. Instead, you should:</p>
<ul>
<li>Track the readiness of an individual merge request with <strong>Draft</strong> or <strong>Ready</strong> status.</li>
<li>Enforce the order merge requests merge with a merge request dependency.</li>
</ul>
<p>Merge request dependencies are a feature in GitLab Premium, but GitLab enforces this restriction
only for the dependent merge request:</p>
<ul>
<li>A GitLab Premium project's merge request can depend on any other merge request, even in a GitLab Free project.</li>
<li>A GitLab Free project's merge request cannot depend on other merge requests.</li>
</ul>
<h2>Nested dependencies</h2>
<p>GitLab versions 16.7 and later support indirect, nested dependencies. A merge request can have up to 10 blockers,
and in turn it can block up to 10 other merge requests. In this example, <code>myfriend/library!10</code>
depends on <code>herfriend/another-lib!1</code>, which in turn depends on <code>mycorp/example!100</code>:</p>
<pre><code class="language-mermaid">%%{init: { &quot;fontFamily&quot;: &quot;GitLab Sans&quot; }}%%

graph LR;
    accTitle: Merge request dependency chain
    accDescr: Flowchart that shows how merge request A depends on merge request B, while merge request B depends on merge request C
    A[myfriend/library!10]--&gt;|depends on| B[herfriend/another-lib!1]
    B--&gt;|depends on| C[mycorp/example!100]
</code></pre>
<p>Nested dependencies do not display in the GitLab UI, but UI support is
proposed in <a href="https://gitlab.com/groups/gitlab-org/-/epics/5308">epic 5308</a>.</p>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>A merge request cannot depend on itself (self-referential), but it's possible to create circular dependencies.</p>
<p>{{&lt; /alert &gt;}}</p>
<h2>View dependencies for a merge request</h2>
<p>If a merge request is dependent on another, the merge request reports section shows
information about the dependency:</p>
<p><img alt="Dependencies in merge request widget" src="img/dependencies_view_v15_3.png" /></p>
<p>To view dependency information on a merge request:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your project.</li>
<li>Select <strong>Code</strong> &gt; <strong>Merge requests</strong> and identify your merge request.</li>
<li>Scroll to the merge request reports area. Dependent merge requests display information
   about the total number of dependencies set, such as
   <strong>Depends on 1 merge request being merged</strong>.</li>
<li>Select <strong>Expand</strong> to view the title, milestone, assignee, and pipeline status
   of each dependency.</li>
</ol>
<p>Until your merge request's dependencies all merge, your merge request cannot merge. The message
<strong>Merge blocked: you can only merge after the above items are resolved</strong> displays.</p>
<h3>Closed merge requests</h3>
<p>Closed merge requests still prevent their dependents from merging, because a merge request can close
without merging its planned work. If a merge request closes and the dependency is no longer relevant,
remove it as a dependency to unblock the dependent merge request.</p>
<h2>Create a new dependent merge request</h2>
<p>When you create a new merge request, you can prevent it from merging until after
other specific work merges. This dependency works even if the merge request is in a different project.</p>
<p>Prerequisites:</p>
<ul>
<li>You must have at least the Developer role, or have permission to create merge requests in the project.</li>
<li>The dependent merge request must be in a project in the Premium or Ultimate tier.</li>
</ul>
<p>To create a new merge request and mark it as dependent on another:</p>
<ol>
<li><a href="creating_merge_requests.html">Create a new merge request</a>.</li>
<li>In <strong>Merge request dependencies</strong>, paste either the reference or the full URL
   to the merge requests that should merge before this work merges. References
   are in the form of <code>path/to/project!merge_request_id</code>.</li>
<li>Select <strong>Create merge request</strong>.</li>
</ol>
<h2>Edit a merge request to add a dependency</h2>
<p>You can edit an existing merge request and mark it as dependent on another.</p>
<p>Prerequisites:</p>
<ul>
<li>You must have at least the Developer role or have permission to edit merge requests in the project.</li>
</ul>
<p>To do this:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your project.</li>
<li>Select <strong>Code</strong> &gt; <strong>Merge requests</strong> and identify your merge request.</li>
<li>Select <strong>Edit</strong>.</li>
<li>In <strong>Merge request dependencies</strong>, paste either the reference or the full URL
   to the merge requests that should merge before this work merges. References
   are in the form of <code>path/to/project!merge_request_id</code>.</li>
</ol>
<h2>Remove a dependency from a merge request</h2>
<p>You can edit a dependent merge request and remove a dependency.</p>
<p>Prerequisites:</p>
<ul>
<li>
<p>You must have a role for the project that allows you to edit merge requests.</p>
</li>
<li>
<p>On the top bar, select <strong>Search or go to</strong> and find your project.</p>
</li>
<li>Select <strong>Code</strong> &gt; <strong>Merge requests</strong> and identify your merge request.</li>
<li>Select <strong>Edit</strong>.</li>
<li>Scroll to <strong>Merge request dependencies</strong> and select <strong>Remove</strong> next to the reference
   for each dependency you want to remove.</li>
</ul>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>Merge request dependencies you do not have permission to view are shown as
   <strong>1 inaccessible merge request</strong>. You can still remove the dependency.</p>
<p>{{&lt; /alert &gt;}}</p>
<ol>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<h2>Troubleshooting</h2>
<h3>Preserve dependencies on project import or export</h3>
<p>Dependencies are not preserved when you import or export a project. For more
information, see <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/12549">issue #12549</a>.</p></code></pre>
</body>
</html>
