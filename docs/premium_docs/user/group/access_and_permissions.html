<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Group push rules</title>
    <link rel="stylesheet" href="/../../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: Tenant Scale
group: Organizations
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
title: Group access and permissions</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Free, Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>Configure your groups to control group permissions and access.
For more information, see also <a href="../project/members/sharing_projects_groups.html">Sharing projects and groups</a>.</p>
<h2>Group push rules</h2>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>Group push rules allow group maintainers to set
<a href="../project/repository/push_rules.html">push rules</a> for newly created projects in the specific group.</p>
<p>To configure push rules for a group:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>Repository</strong>.</li>
<li>Expand the <strong>Pre-defined push rules</strong> section.</li>
<li>Select the settings you want.</li>
<li>Select <strong>Save push rules</strong>.</li>
</ol>
<p>New projects inherit push rules from:</p>
<ul>
<li>The closest parent group with push rules defined.</li>
<li>Push rules set for the entire instance, if no parent groups have push rules defined.</li>
</ul>
<p>Only projects inherit push rules. Subgroups don't inherit push
rules from parent groups. To verify which push rules apply to new projects,
create a project in the subgroup and check the project's push rules.</p>
<h2>Restrict Git access protocols</h2>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/365601">Introduced</a> in GitLab 15.1.</li>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/365357">Feature flag removed</a> in GitLab 16.0.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>You can set the permitted protocols used to access a group's repositories to either SSH, HTTPS, or both. This setting
is disabled when the <a href="../../administration/settings/visibility_and_access_controls.md#configure-enabled-git-access-protocols">instance setting</a> is
configured by an administrator.</p>
<p>To change the permitted Git access protocols for a group:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>General</strong>.</li>
<li>Expand the <strong>Permissions and group features</strong> section.</li>
<li>Choose the permitted protocols from <strong>Enabled Git access protocols</strong>.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<h2>Restrict group access by IP address</h2>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>To ensure only people from your organization can access particular resources, you can restrict access to groups by IP
address. This top-level group setting applies to:</p>
<ul>
<li>The GitLab UI, including subgroups, projects, and issues. It does not apply to GitLab Pages.</li>
<li>The API.</li>
<li>On GitLab Self-Managed you can also configure
  <a href="../../administration/settings/visibility_and_access_controls.md#configure-globally-allowed-ip-address-ranges">globally-allowed IP address ranges</a>
  for the group.</li>
</ul>
<p>Administrators can combine restricted access by IP address with
<a href="../../administration/settings/visibility_and_access_controls.md#configure-globally-allowed-ip-address-ranges">globally-allowed IP addresses</a>.</p>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>IP restriction requires proper configuration of the <code>X-Forwarded-For</code> header. To limit the risk
of IP spoofing, you must overwrite, and not append, any <code>X-Forwarded-For</code> headers sent by clients.</p>
<p>For deployments without an upstream proxy or load balancer, configure the server that receives direct
requests from users to preserve the original client IP address and overwrite any <code>X-Forwarded-For</code> headers.
In NGINX, for example, modify your configuration file to include:</p>
<pre><code class="language-plaintext">proxy_set_header X-Forwarded-For $remote_addr;
</code></pre>
<p>For deployments with an upstream proxy or load balancer, configure the proxy or load balancer to
preserve the original client IP address and overwrite any <code>X-Forwarded-For</code> headers. This approach ensures that
GitLab receives the full chain of IPs, starting from the original client, and can correctly evaluate
the IP restrictions. In NGINX, for example, modify your configuration file to include:</p>
<pre><code class="language-plaintext">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</code></pre>
<p>{{&lt; /alert &gt;}}</p>
<p>To restrict group access by IP address:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>General</strong>.</li>
<li>Expand the <strong>Permissions and group features</strong> section.</li>
<li>In the <strong>Restrict access by IP address</strong> text box, enter a list of IPv4 or IPv6
   address ranges in CIDR notation. This list:</li>
<li>Has no limit on the number of IP address ranges.</li>
<li>Applies to both SSH or HTTP authorized IP address ranges. You cannot split
     this list by type of authorization.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<h3>Security implications</h3>
<p>IP access restrictions limit access to groups and projects, but are not a complete firewall.
While this feature generally limits access to group and project resources, some information
may still be accessible to restricted users. Keep in mind the following (non-exhaustive)
list of security implications when accessing GitLab from a disallowed IP address:</p>
<ul>
<li>Administrators and group Owners can always access group settings.</li>
<li>Administrators can always access projects in the group. This includes cloning code.</li>
<li>Group Owners can always access subgroups, but not any projects in the group or subgroups.</li>
<li>Users can always access shared resources.</li>
<li>Users can always view the names and hierarchies of groups and projects.</li>
<li>Users can always use the <a href="../../administration/reply_by_email.html">reply by email feature</a>
  to create and edit comments on issues or merge requests.</li>
<li>Users can sometimes view push, merge, issue, or comment events on their dashboard.</li>
<li>IP restrictions always apply to public projects, but cached project files may sometimes be accessible.</li>
<li>IP restrictions always apply to Git operations through SSH on GitLab.com and GitLab Dedicated.
  GitLab Self-Managed instances should use <code>gitlab-sshd</code> with
  <a href="../../administration/operations/gitlab_sshd.md#proxy-protocol-support">PROXY protocol</a> enabled.</li>
<li>IP restrictions always apply to Git clone operations performed by CI/CD jobs.</li>
<li>IP restrictions do not apply to runner registration or when runners request or update CI/CD jobs.</li>
<li>IP restrictions might not apply to forked projects or actions that indirectly interact with issues
  or artifacts in an IP-restricted group. For example, a merge request that closes an issue in an
  IP-restricted group by using an issue reference in the merge request description.</li>
</ul>
<h3>GitLab.com access restrictions</h3>
<p>IP address-based group access restriction does not work with <a href="../../ci/runners/hosted_runners/_index.html">hosted runners for GitLab.com</a>.
These runners operate as ephemeral virtual machines with <a href="../gitlab_com/_index.md#ip-range">dynamic IP addresses</a>
from large cloud provider pools (AWS, Google Cloud). Allowing these broad IP ranges defeats the
purpose of IP address-based access restriction.</p>
<h2>Restrict group access by domain</h2>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Support for restricting group memberships to groups with a subset of the allowed email domains <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/354791">added</a> in GitLab 15.1.1</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>You can define an email domain allowlist at the top-level namespace to restrict which users can
access a group and its projects. A user's primary email domain must match an entry in the allowlist
to access that group. Subgroups inherit the same allowlist.</p>
<p>To restrict group access by domain:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>General</strong>.</li>
<li>Expand the <strong>Permissions and group features</strong> section.</li>
<li>In the <strong>Restrict membership by email domain</strong> text box, enter the domain names to allow.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<p>The next time you attempt to add a user to the group, their <a href="../profile/_index.md#change-your-primary-email">primary email</a>
must match one of the allowed domains.</p>
<p>You cannot restrict the most popular public email domains, such as:</p>
<ul>
<li><code>aol.com</code>, <code>gmail.com</code>, <code>hotmail.co.uk</code>, <code>hotmail.com</code>,</li>
<li><code>hotmail.fr</code>, <code>icloud.com</code>, <code>live.com</code>, <code>mail.com</code>,</li>
<li><code>me.com</code>, <code>msn.com</code>, <code>outlook.com</code>,</li>
<li><code>proton.me</code>, <code>protonmail.com</code>, <code>tutanota.com</code>,</li>
<li><code>yahoo.com</code>, <code>yandex.com</code>, <code>zohomail.com</code></li>
</ul>
<p>When you share a group, both the source and target namespaces must allow the domains of the members' email addresses.</p>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>Removing a domain from the <strong>Restrict membership by email domain</strong> list does not remove existing users with that domain from the group or its projects.
Also, if you share a group or project with another group, the target group can add more email domains to its list that are not in the list of the source group.
Hence, this feature does not ensure that the current members always conform to the <strong>Restrict membership by email domain</strong> list.</p>
<p>{{&lt; /alert &gt;}}</p>
<h2>Prevent users from requesting access to a group</h2>
<p>As a group Owner, you can prevent non-members from requesting access to
your group.</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>General</strong>.</li>
<li>Expand the <strong>Permissions and group features</strong> section.</li>
<li>Clear the <strong>Allow users to request access</strong> checkbox.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>Disabling the <strong>Allow users to request access</strong> setting prevents new access requests.
Existing pending requests are not removed and can still be approved or denied.</p>
<p>{{&lt; /alert &gt;}}</p>
<h2>Prevent project forking outside group</h2>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>By default, projects in a group can be forked.
However, you can prevent the projects in a group from being forked outside of the current top-level group.</p>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>Prevent forking outside the top-level group when possible to reduce potential avenues for bad actors.
However, if you expect a lot of external collaboration, allowing forks outside the top-level group might be unavoidable.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>Prerequisites:</p>
<ul>
<li>This setting is enabled on the top-level group only.</li>
<li>All subgroups inherit this setting from the top-level group, and it cannot be
  changed at the subgroup level.</li>
</ul>
<p>To prevent projects from being forked outside the group:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>General</strong>.</li>
<li>Expand the <strong>Permissions and group features</strong> section.</li>
<li>Check <strong>Prevent project forking outside current group</strong>.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<p>Existing forks are not removed.</p>
<h2>Prevent members from being added to projects in a group</h2>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>As a group Owner, you can prevent any new project membership for all
projects in a group, allowing tighter control over project membership.</p>
<p>For example, if you want to lock the group for an <a href="../../administration/compliance/audit_event_reports.html">audit event</a>,
you can guarantee that project membership cannot be modified during the audit.</p>
<p>If group membership lock is enabled, the group Owner can still:</p>
<ul>
<li>Invite groups or add members to groups to give them access to projects in the <strong>locked</strong> group.</li>
<li>Change the role of group members.</li>
</ul>
<p>The setting does not cascade. Projects in subgroups observe the subgroup configuration, ignoring the parent group.</p>
<p>To prevent members from being added to projects in a group:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>General</strong>.</li>
<li>Expand the <strong>Permissions and group features</strong> section.</li>
<li>Under <strong>Membership</strong>, select <strong>Users cannot be added to projects in this group</strong>.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<p>After you lock the membership for a group:</p>
<ul>
<li>All users who previously had permissions can no longer add members to a group.</li>
<li>API requests to add a new user to a project are not possible.</li>
</ul>
<h2>Manage group memberships with LDAP</h2>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab Self-Managed</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>{{&lt; history &gt;}}</p>
<ul>
<li>Support for custom roles for users synced in groups <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/435229">introduced</a> in GitLab 17.2.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>Group syncing allows LDAP groups to be mapped to GitLab groups. This provides more control over per-group user management. To configure group syncing, edit the <code>group_base</code> <strong>DN</strong> (<code>'OU=Global Groups,OU=GitLab INT,DC=GitLab,DC=org'</code>). This <strong>OU</strong> contains all groups that are associated with GitLab groups.</p>
<p>Group links can be created by using either a CN or a filter. To create these group links, go to the group's <strong>Settings</strong> &gt; <strong>LDAP Synchronization</strong> page. After configuring the link, it may take more than an hour for the users to sync with the GitLab group. After you have configured the link:</p>
<ul>
<li>In GitLab 16.7 and earlier, group Owners cannot add members to or remove members from the group. The LDAP server is considered the single source of truth for group membership for all users who have signed in with LDAP credentials.</li>
<li>In GitLab 16.8 and later, group Owners can use the <a href="../../api/member_roles.html">member roles API</a> or <a href="../../api/group_members.md#add-a-member-to-a-group">group members API</a> to add a service account user to or remove a service account user from the group, even when LDAP synchronization is enabled for the group. Group Owners cannot add or remove non-service account users.</li>
</ul>
<p>When a user belongs to two LDAP groups configured for the same GitLab group, GitLab assigns them the
higher of the two associated roles.
For example:</p>
<ul>
<li>User is a member of LDAP groups <code>Owner</code> and <code>Dev</code>.</li>
<li>The GitLab Group is configured with these two LDAP groups.</li>
<li>When group sync is completed, the user is granted the Owner role as this is the higher of the two LDAP group roles.</li>
</ul>
<p>For more information on the administration of LDAP and group sync, refer to the <a href="../../administration/auth/ldap/ldap_synchronization.md#group-sync">main LDAP documentation</a>.</p>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>When you add LDAP group syncing, if an LDAP user is a group member and they are not part of the LDAP group, they are removed from the group.</p>
<p>{{&lt; /alert &gt;}}</p>
<p>You can use a workaround to <a href="../project/working_with_projects.md#manage-project-access-through-ldap-groups">manage project access through LDAP groups</a>.</p>
<h3>Create group links with a CN</h3>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>To create group links with LDAP group CN:</p>
<!-- vale gitlab_base.Spelling = NO -->

<ol>
<li>Select the <strong>LDAP Server</strong> for the link.</li>
<li>As the <strong>Sync method</strong>, select <code>LDAP Group cn</code>.</li>
<li>In the <strong>LDAP Group cn</strong> field, begin typing the CN of the group. There is a dropdown list with matching CNs in the configured <code>group_base</code>. Select your CN from this list.</li>
<li>In the <strong>LDAP Access</strong> section, choose a <a href="../permissions.html">default role</a> or <a href="../custom_roles/_index.html">custom role</a> for users synced in this group.</li>
<li>Select <strong>Add Synchronization</strong>.</li>
</ol>
<!-- vale gitlab_base.Spelling = YES -->

<h3>Create group links with a filter</h3>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>To create group links with an LDAP user filter:</p>
<ol>
<li>Select the <strong>LDAP Server</strong> for the link.</li>
<li>As the <strong>Sync method</strong>, select <code>LDAP user filter</code>.</li>
<li>Input your filter in the <strong>LDAP User filter</strong> box. Follow the <a href="../../administration/auth/ldap/_index.md#set-up-ldap-user-filter">documentation on user filters</a>.</li>
<li>In the <strong>LDAP Access</strong> section, choose a <a href="../permissions.html">default role</a> or <a href="../custom_roles/_index.html">custom role</a> for users synced in this group.</li>
<li>Select <strong>Add Synchronization</strong>.</li>
</ol>
<h3>Remove group links</h3>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>Active synchronization</strong>.</li>
<li>Identify the group link you want to remove and select <strong>Remove</strong>.</li>
</ol>
<p>{{&lt; alert type="note" &gt;}}</p>
<p>When you remove LDAP group syncing, the existing memberships and role assignment are retained.</p>
<p>{{&lt; /alert &gt;}}</p>
<h3>Override user permissions</h3>
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>LDAP user permissions can be manually overridden by an administrator. To override a user's permissions:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Manage</strong> &gt; <strong>Members</strong>. If LDAP synchronization
   has granted a user a role with:</li>
<li>More permissions than the parent group membership, that user is displayed as having
     <a href="../project/members/_index.md#display-direct-members">direct membership</a> of the group.</li>
<li>The same or fewer permissions than the parent group membership, that user is displayed as having
     <a href="../project/members/_index.md#membership-types">inherited membership</a> of the group.</li>
<li>Optional. If the user you want to edit is displayed as having inherited membership,
   <a href="_index.md#filter-a-group">filter the subgroup to show direct members</a> before
   overriding LDAP user permissions.</li>
<li>In the row for the user you are editing, select the pencil ({{&lt; icon name="pencil" &gt;}}) icon.</li>
<li>Select <strong>Edit permissions</strong> in the dialog.</li>
</ol>
<p>Now you can edit the user's permissions from the <strong>Members</strong> page.</p>
<h2>Set the default role that can use pipeline variables</h2>
<p>{{&lt; history &gt;}}</p>
<ul>
<li><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/513117">Introduced</a> in GitLab 17.10.</li>
</ul>
<p>{{&lt; /history &gt;}}</p>
<p>This group setting controls the default value of the <a href="../../ci/variables/_index.md#restrict-pipeline-variables">minimum role allowed to run a new pipeline with pipeline variables</a>
project setting. New projects created in the group have this value selected by default.</p>
<p>Prerequisites:</p>
<ul>
<li>You must have at least the Maintainer role in the group.</li>
<li>The group must be the top-level group, not a subgroup.</li>
</ul>
<p>To set the default minimum role:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your group.</li>
<li>Select <strong>Settings</strong> &gt; <strong>CI/CD</strong> &gt; <strong>Variables</strong>.</li>
<li>Under <strong>Default role to use pipeline variables</strong> select a minimum role, or select
   <strong>No one allowed</strong> to prevent any user from using pipeline variables.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<p>After a new project is created, project members with at least the Maintainer role
can change the project setting to another value if needed.</p>
<h2>Troubleshooting</h2>
<h3>Verify if access is blocked by IP restriction</h3>
<p>If a user sees a 404 error when they try to access a specific group,
their access might be blocked by an IP restriction.</p>
<p>Search the <code>auth.log</code> rails log for one or more of the following entries:</p>
<ul>
<li><code>json.message</code>: <code>'Attempting to access IP restricted group'</code></li>
<li><code>json.allowed</code>: <code>false</code></li>
</ul>
<p>In viewing the log entries, compare <code>remote.ip</code> with the list of <a href="#restrict-group-access-by-ip-address">allowed IP addresses</a> for the group.</p>
<h3>Cannot update permissions for a group member</h3>
<p>If a group Owner cannot update permissions for a group member, check which memberships
are listed. Group Owners can only update direct memberships.</p>
<p>Members added directly to a subgroup are still considered <a href="../project/members/_index.md#membership-types">inherited members</a>
if they have the same or a higher role in the parent group.</p>
<p>To view and update direct memberships, <a href="_index.md#filter-a-group">filter the group to show direct members</a>.</p>
<p><a href="https://gitlab.com/gitlab-org/gitlab/-/issues/337539#note_1277786161">Issue 337539</a> proposes a redesigned members page that lists both direct and indirect memberships with the ability to filter by type.</p>
<h3>Cannot clone or pull using SSH after enabling IP restrictions</h3>
<p>If you have issues with Git SSH operations after adding IP address restrictions,
check if your connection defaults to IPv6.</p>
<p>Some operating systems prioritize IPv6 over IPv4 when both are available,
which might not be obvious from the Git terminal feedback.</p>
<p>If your connection uses IPv6, you can resolve this issue by adding the IPv6 address to the allowlist.</p></code></pre>
</body>
</html>
