<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Prerequisites</title>
    <link rel="stylesheet" href="/../../style.css">
</head>
<body>
    <pre><code><hr />
<p>stage: Verify
group: Pipeline Execution
info: To determine the technical writer assigned to the Stage/Group associated with this page, see https://handbook.gitlab.com/handbook/product/ux/technical-writing/#assignments
title: Merged results pipelines</p>
<hr />
<p>{{&lt; details &gt;}}</p>
<ul>
<li>Tier: Premium, Ultimate</li>
<li>Offering: GitLab.com, GitLab Self-Managed, GitLab Dedicated</li>
</ul>
<p>{{&lt; /details &gt;}}</p>
<p>A merged results pipeline runs on the result of the source and target branches merged together.
It is a type of <a href="merge_request_pipelines.html">merge request pipeline</a>.</p>
<p>GitLab creates an internal commit with the merged results, so the pipeline can run
against it. This commit does not exist in either branch,
but you can view it in the pipeline details. The author of the internal commit is
always the user that created the merge request.</p>
<p>The pipeline runs against the target branch as it exists at the moment you run the pipeline.
Over time, while you're working in the source branch, the target branch might change.
Any time you want to be sure the merged results are accurate, you should re-run the pipeline.</p>
<p>Merged results pipelines can't run when the target branch has changes that conflict with the changes in the source branch.
In these cases, the pipeline runs as a <a href="merge_request_pipelines.html">merge request pipeline</a>
and is labeled as <code>merge request</code>.</p>
<h2>Prerequisites</h2>
<p>To use merged results pipelines:</p>
<ul>
<li>Your project's <code>.gitlab-ci.yml</code> file must be configured to
  <a href="merge_request_pipelines.md#prerequisites">run jobs in merge request pipelines</a>.</li>
<li>Your repository must be a GitLab repository, not an
  <a href="../ci_cd_for_external_repos/_index.html">external repository</a>.</li>
</ul>
<h2>Enable merged results pipelines</h2>
<p>To enable merged results pipelines in a project, you must have at least the
Maintainer role:</p>
<ol>
<li>On the top bar, select <strong>Search or go to</strong> and find your project.</li>
<li>Select <strong>Settings</strong> &gt; <strong>Merge requests</strong>.</li>
<li>In the <strong>Merge options</strong> section, select <strong>Enable merged results pipelines</strong>.</li>
<li>Select <strong>Save changes</strong>.</li>
</ol>
<p>{{&lt; alert type="warning" &gt;}}</p>
<p>If you select the checkbox but don't configure your pipeline to use
merge request pipelines, your merge requests may become stuck in an
unresolved state or your pipelines may be dropped.</p>
<p>{{&lt; /alert &gt;}}</p>
<h2>Troubleshooting</h2>
<h3>Jobs or pipelines run unexpectedly with <code>rules:changes:compare_to</code></h3>
<p>You might have jobs or pipelines that run unexpectedly when using <code>rules:changes:compare_to</code> with merge request pipelines.</p>
<p>With merged results pipelines, the internal commit that GitLab creates is used as a base to compare against. This commit likely contains more changes than the tip of the MR branch, which causes unexpected outcomes.</p>
<h3>Successful merged results pipeline overrides a failed branch pipeline</h3>
<p>A failed branch pipeline is sometimes ignored when the
<a href="../../user/project/merge_requests/auto_merge.md#require-a-successful-pipeline-for-merge"><strong>Pipelines must succeed</strong> setting</a>
is activated.
<a href="https://gitlab.com/gitlab-org/gitlab/-/issues/385841">Issue 385841</a> is open to track this.</p></code></pre>
</body>
</html>
